'use strict';const _0xfd8603=_0x3907;(function(_0x35ec23,_0x124609){const _0x3583a3=_0x3907,_0x4e321e=_0x35ec23();while(!![]){try{const _0x3f7ec9=parseInt(_0x3583a3(0x18b))/0x1+-parseInt(_0x3583a3(0x1b7))/0x2*(-parseInt(_0x3583a3(0x1d7))/0x3)+-parseInt(_0x3583a3(0x1bf))/0x4+-parseInt(_0x3583a3(0x1a3))/0x5+-parseInt(_0x3583a3(0x1b0))/0x6+-parseInt(_0x3583a3(0x22d))/0x7+parseInt(_0x3583a3(0x1db))/0x8*(parseInt(_0x3583a3(0x1f9))/0x9);if(_0x3f7ec9===_0x124609)break;else _0x4e321e['push'](_0x4e321e['shift']());}catch(_0x11eb81){_0x4e321e['push'](_0x4e321e['shift']());}}}(_0x42f6,0xa5b9f));const _0x410a14=_0x3d8a;function _0x3907(_0x358910,_0x226a88){const _0x42f600=_0x42f6();return _0x3907=function(_0x390728,_0x2fd3e9){_0x390728=_0x390728-0x177;let _0x5b523b=_0x42f600[_0x390728];return _0x5b523b;},_0x3907(_0x358910,_0x226a88);}(function(_0x2fd5ef,_0x4cffd8){const _0x21db31=_0x3907,_0x28981e=_0x3d8a,_0x288cff=_0x2fd5ef();while(!![]){try{const _0x5042b0=-parseInt(_0x28981e(0x1dc))/0x1+-parseInt(_0x28981e(0x1a2))/0x2+-parseInt(_0x28981e(0x175))/0x3*(-parseInt(_0x28981e(0x1c3))/0x4)+-parseInt(_0x28981e(0x13a))/0x5+parseInt(_0x28981e(0x14c))/0x6+parseInt(_0x28981e(0x162))/0x7*(parseInt(_0x28981e(0x1d8))/0x8)+-parseInt(_0x28981e(0x142))/0x9*(-parseInt(_0x28981e(0x18f))/0xa);if(_0x5042b0===_0x4cffd8)break;else _0x288cff[_0x21db31(0x1c3)](_0x288cff['shift']());}catch(_0x40d86a){_0x288cff[_0x21db31(0x1c3)](_0x288cff[_0x21db31(0x1d0)]());}}}(_0x3304,0xe2822));const _0x456bd4=_0x19fc;(function(_0x516880,_0x167130){const _0x34d902=_0x3907,_0x127796=_0x3d8a,_0xb04884=_0x19fc,_0x206ac7=_0x516880();while(!![]){try{const _0x3b47ca=-parseInt(_0xb04884(0x199))/0x1*(parseInt(_0xb04884(0x194))/0x2)+-parseInt(_0xb04884(0x1b9))/0x3*(parseInt(_0xb04884(0x14f))/0x4)+parseInt(_0xb04884(0x1be))/0x5*(-parseInt(_0xb04884(0x1a7))/0x6)+-parseInt(_0xb04884(0x195))/0x7*(-parseInt(_0xb04884(0x1ad))/0x8)+parseInt(_0xb04884(0x165))/0x9+parseInt(_0xb04884(0x122))/0xa+-parseInt(_0xb04884(0x171))/0xb*(-parseInt(_0xb04884(0x17d))/0xc);if(_0x3b47ca===_0x167130)break;else _0x206ac7[_0x127796(0x19b)](_0x206ac7[_0x127796(0x165)]());}catch(_0xd0fd32){_0x206ac7[_0x34d902(0x1c3)](_0x206ac7[_0x127796(0x165)]());}}}(_0x2f8d,0xc6b66));var __decorate=this&&this[_0x456bd4(0x1b0)]||function(_0x964ff2,_0x17d1da,_0xdb7470,_0x387c8a){const _0x256443=_0x3907,_0xe768c8=_0x456bd4;var _0x398ce3=arguments[_0x256443(0x22c)],_0x154e42=_0x398ce3<0x3?_0x17d1da:_0x387c8a===null?_0x387c8a=Object[_0xe768c8(0x1d9)](_0x17d1da,_0xdb7470):_0x387c8a,_0x365e21;if(typeof Reflect===_0x256443(0x1df)&&typeof Reflect[_0xe768c8(0x172)]===_0xe768c8(0x15b))_0x154e42=Reflect[_0xe768c8(0x172)](_0x964ff2,_0x17d1da,_0xdb7470,_0x387c8a);else{for(var _0x2dd386=_0x964ff2[_0xe768c8(0x18b)]-0x1;_0x2dd386>=0x0;_0x2dd386--)if(_0x365e21=_0x964ff2[_0x2dd386])_0x154e42=(_0x398ce3<0x3?_0x365e21(_0x154e42):_0x398ce3>0x3?_0x365e21(_0x17d1da,_0xdb7470,_0x154e42):_0x365e21(_0x17d1da,_0xdb7470))||_0x154e42;}return _0x398ce3>0x3&&_0x154e42&&Object[_0xe768c8(0x1aa)](_0x17d1da,_0xdb7470,_0x154e42),_0x154e42;},__metadata=this&&this[_0xfd8603(0x1fa)]||function(_0x27396c,_0x53a08d){const _0x549c9c=_0x3d8a,_0x251765=_0x456bd4;if(typeof Reflect===_0x549c9c(0x159)&&typeof Reflect[_0x251765(0x1a0)]===_0x251765(0x15b))return Reflect[_0x251765(0x1a0)](_0x27396c,_0x53a08d);},__param=this&&this[_0x456bd4(0x1cd)]||function(_0x343509,_0x4e6944){return function(_0x3ee776,_0x231112){_0x4e6944(_0x3ee776,_0x231112,_0x343509);};};function _0x19fc(_0x5a3046,_0x488079){const _0x2f7ae7=_0x2f8d();return _0x19fc=function(_0x2c1ee9,_0x5367e9){_0x2c1ee9=_0x2c1ee9-0x11e;let _0x4ee9cd=_0x2f7ae7[_0x2c1ee9];return _0x4ee9cd;},_0x19fc(_0x5a3046,_0x488079);}function _0x3d8a(_0x8d783c,_0x3db3a4){const _0x3a45db=_0x3304();return _0x3d8a=function(_0x1ffd6e,_0x46634a){_0x1ffd6e=_0x1ffd6e-0x138;let _0x2db6a5=_0x3a45db[_0x1ffd6e];return _0x2db6a5;},_0x3d8a(_0x8d783c,_0x3db3a4);}function _0x42f6(){const _0x136384=['invitedGuestSendModel4Count','860938XHTsbC','registerSendModel3Count','cramiPackageEntity','forEach','invitedGuestSendModel3Count','formatDate','---','setConfig','RechargeType','chatGroupEntity','sumModel3Count','getRechargeLog','accountLogEntity','balanceEntity','Injectable','查询当前用户余额失败！','phone','147309sYWRYl','45052TLutxd','useCount','../chatLog/chatLog.entity','./fingerprint.entity','inviteSendStatus','./userBalance.entity','debug','memberDrawMjCount','sumModel4Count','../sales/salesUsers.entity','includes','firstRegisterSendStatus','getAccountLog','当前套餐不存在！','注册赠送失败,请联系管理员！','reduce','addBalanceToNewUser','27990dtzxjJ','INVITE_GIFT','SalesUsersEntity','isUpdatedToday','userId','../../common/utils/date','ChatGroupEntity','109080HIxoth','goodsId','format','查询用户账户失败！','registerSendModel4Count','REG_GIFT','configVal','model3Count','../user/user.entity','查询用户账户信息失败！','useModel4Token','DESC','1165594xVhbVv','4730304jeXwPm','@nestjs/common','充值的工单信息:','Repository','packageId','当前用户无需创建账户信息！','userEntity','101982GBOeSZ','refundMjBalance','495355pXolnK','inheritVisitorData','inviteGiveSendModel3Count','avatar','isInteger','1413qpNiJK','3162008ivbRiv','then','whiteListEntity','2716998nEdxOn','push','firstRregisterSendModel4Count','useModel4Count','createRandomUid','__decorate','firstRregisterSendDrawMjCount','旧账户信息迁移成功','LessThan','hideString','11405070Cepzgc','6jqtVsb','username','./accountLog.entity','shift','16lXdfEd','>\x20或购买专属套餐\x20！','您已经升级过了、请勿重复操作！','configKey','__param','visitorModel3Num','51yJgvOL','headers','drawMjCount','default','1256mAiXhN','getOwnPropertyDescriptor','useModel3Count','salesUsersEntity','object','../midjourney/midjourney.entity','saveRecordRechargeLog','saveCommissionAmount','typeorm','YYYY-MM-DD','userBalanceEntity','save','invitedGuestSendDrawMjCount','model4Count','useModel3Token','旧账户信息迁移失败','defineProperty','user','upgradeBalance','inviteGiveSendModel4Count','total','sumDrawMjCount','缺失当前套餐ID、充值失败！','error:\x20','validateVisitorBalance','updatedAt','weight','firstRegisterSendRank','../crami/cramiPackage.entity','52ublsdC','122013RRBvFj','__metadata','./balance.entity','salesService','../chatgpt/whiteList.entity','消费余额失败！','day','createSalesRecords','getVisitorCount','deductFromBalance','100376rklTtn','FingerprintLogEntity','expirationTime','3298915oVeDxM','../globalConfig/globalConfig.service','validateBalance','SCAN_PAY','firstRregisterSendModel3Count','BalanceService','HttpException','YYYY-MM-DD\x20HH:mm:ss','MjCount','../sales/sales.service','function','upgradeStatus','getFullYear','map','commissionAmount','registerSendDrawMjCount','充值失败！','@nestjs/typeorm','1017oORhyf','BAD_REQUEST','getConfigs','../chatGroup/chatGroup.entity','用户充值失败！','email','log','HttpStatus','InjectRepository','缺失当前用户账户记录！','metadata','充值失败','update','days','addBalanceToOrder','GlobalConfigService','design:paramtypes','registerSendStatus','当前用户不存在,记录充值日志异常','inviteGiveSendDrawMjCount','length','5325817fJkNJi','644035XhPNEo','3148OxPvMR','非法操作、当前充值套餐暂不存在！'];_0x42f6=function(){return _0x136384;};return _0x42f6();}Object[_0x456bd4(0x1aa)](exports,_0x456bd4(0x12d),{'value':!![]}),exports[_0x410a14(0x1ad)]=void 0x0;const globalConfig_service_1=require(_0x410a14(0x146)),typeorm_1=require(_0x456bd4(0x152)),balance_entity_1=require(_0x456bd4(0x141)),common_1=require(_0x456bd4(0x1b3)),typeorm_2=require(_0x456bd4(0x1db)),balance_constant_1=require(_0x456bd4(0x191)),accountLog_entity_1=require(_0x456bd4(0x154)),utils_1=require(_0x456bd4(0x157)),config_entity_1=require(_0x410a14(0x14d)),cramiPackage_entity_1=require(_0x410a14(0x1c9)),userBalance_entity_1=require(_0x456bd4(0x184)),date_1=require(_0x410a14(0x197)),user_entity_1=require(_0x456bd4(0x14a)),salesUsers_entity_1=require(_0x456bd4(0x1e0)),sales_service_1=require(_0x456bd4(0x1ae)),whiteList_entity_1=require(_0x456bd4(0x138)),fingerprint_entity_1=require(_0x456bd4(0x135)),chatLog_entity_1=require(_0x410a14(0x1f4)),chatGroup_entity_1=require(_0x456bd4(0x15e)),midjourney_entity_1=require(_0x456bd4(0x11f));function _0x3304(){const _0x3eb5bf=_0xfd8603,_0x5b956c=[_0x3eb5bf(0x191),_0x3eb5bf(0x19c),_0x3eb5bf(0x1e7),_0x3eb5bf(0x17b),'catch','findAndCount',_0x3eb5bf(0x21f),_0x3eb5bf(0x1ea),_0x3eb5bf(0x19a),_0x3eb5bf(0x1a1),_0x3eb5bf(0x228),_0x3eb5bf(0x19f),_0x3eb5bf(0x211),_0x3eb5bf(0x1c3),_0x3eb5bf(0x1dd),_0x3eb5bf(0x1ab),_0x3eb5bf(0x216),'ChatLogEntity',_0x3eb5bf(0x224),_0x3eb5bf(0x1ef),_0x3eb5bf(0x179),'useDrawMjToken','save','__esModule',_0x3eb5bf(0x1a8),_0x3eb5bf(0x1d2),_0x3eb5bf(0x1fd),_0x3eb5bf(0x1e5),_0x3eb5bf(0x1a9),_0x3eb5bf(0x20c),'../../common/utils','UserBalanceService',_0x3eb5bf(0x1de),'weight',_0x3eb5bf(0x1ae),'queryUserBalanceByIds','WhiteListEntity',_0x3eb5bf(0x182),_0x3eb5bf(0x1ff),_0x3eb5bf(0x1ec),_0x3eb5bf(0x1be),'registerSendDrawMjCount','addBalanceToUser','Logger','midjourneyEntity','visitorModel4Num',_0x3eb5bf(0x1d9),_0x3eb5bf(0x1cf),'formatCreateOrUpdateDate',_0x3eb5bf(0x1e3),_0x3eb5bf(0x198),'length',_0x3eb5bf(0x1c5),_0x3eb5bf(0x1f8),'36gtvRBh',_0x3eb5bf(0x1fb),_0x3eb5bf(0x227),'queryUserBalance','visitor',_0x3eb5bf(0x1f7),'writeOldBalanceToNewTable',_0x3eb5bf(0x221),_0x3eb5bf(0x1f2),'PAYMENT_REQUIRED',_0x3eb5bf(0x1a2),_0x3eb5bf(0x1ca),'memberModel3Count',_0x3eb5bf(0x177),_0x3eb5bf(0x1b2),_0x3eb5bf(0x217),'SalesService',_0x3eb5bf(0x21a),_0x3eb5bf(0x22f),_0x3eb5bf(0x18e),_0x3eb5bf(0x203),_0x3eb5bf(0x1ad),'13202550NWejbl','globalConfigService',_0x3eb5bf(0x1b9),_0x3eb5bf(0x183),_0x3eb5bf(0x1d8),'MidjourneyEntity',_0x3eb5bf(0x22b),_0x3eb5bf(0x17a),_0x3eb5bf(0x189),_0x3eb5bf(0x20a),'email',_0x3eb5bf(0x18c),_0x3eb5bf(0x20e),_0x3eb5bf(0x220),_0x3eb5bf(0x1a7),'createBaseUserBalance',_0x3eb5bf(0x1d6),'chatLogEntity',_0x3eb5bf(0x208),'model3',_0x3eb5bf(0x1ee),_0x3eb5bf(0x1eb),_0x3eb5bf(0x19e),_0x3eb5bf(0x225),_0x3eb5bf(0x1a0),_0x3eb5bf(0x1af),_0x3eb5bf(0x18d),'toFixed',_0x3eb5bf(0x210),_0x3eb5bf(0x195),'odel4',_0x3eb5bf(0x1d1),_0x3eb5bf(0x192),_0x3eb5bf(0x1cb),'memberModel4Count',_0x3eb5bf(0x1c9),'model4',_0x3eb5bf(0x1cd),_0x3eb5bf(0x1d4),_0x3eb5bf(0x1a5),_0x3eb5bf(0x20b),_0x3eb5bf(0x1c6),_0x3eb5bf(0x1c0),'add','3854580PKhlQj','ConfigEntity',_0x3eb5bf(0x180),'super',_0x3eb5bf(0x17d),'packageId',_0x3eb5bf(0x181),_0x3eb5bf(0x1dc),_0x3eb5bf(0x218),_0x3eb5bf(0x205),_0x3eb5bf(0x1f6),'inviteGiveSendModel3Count',_0x3eb5bf(0x207),_0x3eb5bf(0x1fc),_0x3eb5bf(0x1c8),_0x3eb5bf(0x188),_0x3eb5bf(0x219),_0x3eb5bf(0x1f4),_0x3eb5bf(0x1c2),'../globalConfig/config.entity',_0x3eb5bf(0x1e8),_0x3eb5bf(0x17c),'findOne',_0x3eb5bf(0x226),'2kPsHsh',_0x3eb5bf(0x1b8),'model3Count',_0x3eb5bf(0x214),_0x3eb5bf(0x185),_0x3eb5bf(0x196),_0x3eb5bf(0x21c),_0x3eb5bf(0x1df),_0x3eb5bf(0x1c1),'expireDateCn',_0x3eb5bf(0x223),'您的账户余额不足,如果想继续体验服务,请联系管理员\x20<VX:\x20',_0x3eb5bf(0x186),_0x3eb5bf(0x187),'find',_0x3eb5bf(0x229),'679jWzdvj',_0x3eb5bf(0x1fe),'BalanceEntity','shift',_0x3eb5bf(0x190),_0x3eb5bf(0x1f3),_0x3eb5bf(0x1d3),_0x3eb5bf(0x194),_0x3eb5bf(0x212),'count',_0x3eb5bf(0x18f),_0x3eb5bf(0x1e1),'UserEntity','mjDraw',_0x3eb5bf(0x19d),_0x3eb5bf(0x1b6),'UserBalanceEntity',_0x3eb5bf(0x1d5),_0x3eb5bf(0x1c7),_0x3eb5bf(0x18a),_0x3eb5bf(0x21e),'vxNumber',_0x3eb5bf(0x209),_0x3eb5bf(0x1ce),'../../common/constants/balance.constant','fingerprintLogEntity','avatar','affected',_0x3eb5bf(0x201),'odel3',_0x3eb5bf(0x1e9),_0x3eb5bf(0x202),_0x3eb5bf(0x184),_0x3eb5bf(0x1e4),_0x3eb5bf(0x1ed),_0x3eb5bf(0x197),'visitorMJNum',_0x3eb5bf(0x22a),'configEntity','decorate',_0x3eb5bf(0x1b3),'status',_0x3eb5bf(0x20d),_0x3eb5bf(0x1bd)];return _0x3304=function(){return _0x5b956c;},_0x3304();}function _0x2f8d(){const _0x3f99bc=_0xfd8603,_0x3d684d=_0x410a14,_0x573925=[_0x3d684d(0x15c),_0x3d684d(0x1f3),_0x3f99bc(0x22e),_0x3f99bc(0x178),_0x3d684d(0x176),_0x3f99bc(0x1bb),_0x3d684d(0x152),_0x3d684d(0x1e8),_0x3d684d(0x161),_0x3d684d(0x1e3),_0x3d684d(0x194),_0x3d684d(0x1fe),_0x3d684d(0x181),_0x3f99bc(0x222),_0x3d684d(0x1a0),_0x3d684d(0x13f),_0x3d684d(0x200),_0x3f99bc(0x200),_0x3d684d(0x1c8),_0x3d684d(0x1ee),_0x3d684d(0x1ff),_0x3d684d(0x1ad),_0x3d684d(0x14a),_0x3d684d(0x1ef),_0x3d684d(0x157),_0x3d684d(0x1ca),_0x3d684d(0x1f9),_0x3f99bc(0x20f),_0x3d684d(0x1eb),_0x3d684d(0x174),_0x3d684d(0x151),_0x3d684d(0x16d),_0x3f99bc(0x1b1),_0x3d684d(0x138),_0x3f99bc(0x19b),_0x3d684d(0x149),_0x3d684d(0x1b2),_0x3d684d(0x16c),_0x3d684d(0x1b6),_0x3d684d(0x19a),_0x3f99bc(0x17e),_0x3d684d(0x199),_0x3d684d(0x18b),_0x3f99bc(0x206),_0x3d684d(0x140),_0x3d684d(0x1bc),'model4Count',_0x3f99bc(0x20c),_0x3d684d(0x1e5),_0x3d684d(0x1e7),_0x3d684d(0x158),_0x3d684d(0x1d0),'>\x20或购买专属套餐\x20！',_0x3d684d(0x183),_0x3d684d(0x187),_0x3d684d(0x1ba),_0x3f99bc(0x1b3),_0x3d684d(0x155),_0x3d684d(0x173),_0x3d684d(0x16b),_0x3d684d(0x203),_0x3d684d(0x172),'getMonth',_0x3d684d(0x19c),_0x3d684d(0x1de),_0x3d684d(0x1f1),_0x3d684d(0x1fc),_0x3d684d(0x168),_0x3d684d(0x195),_0x3d684d(0x17f),_0x3d684d(0x141),_0x3f99bc(0x1a6),_0x3d684d(0x1bf),_0x3d684d(0x156),_0x3d684d(0x1e9),_0x3d684d(0x185),_0x3d684d(0x1ea),_0x3d684d(0x169),_0x3d684d(0x1cf),_0x3f99bc(0x1ba),_0x3f99bc(0x1e0),_0x3d684d(0x1b8),_0x3d684d(0x15f),_0x3d684d(0x1da),_0x3d684d(0x1c6),_0x3d684d(0x1ec),_0x3d684d(0x163),_0x3d684d(0x191),_0x3d684d(0x1d5),_0x3d684d(0x171),'getDate',_0x3d684d(0x198),_0x3d684d(0x154),_0x3d684d(0x1c7),_0x3d684d(0x1a5),_0x3f99bc(0x215),_0x3d684d(0x1b4),_0x3d684d(0x18c),_0x3d684d(0x170),_0x3d684d(0x13b),_0x3f99bc(0x199),_0x3d684d(0x1a9),_0x3d684d(0x1d7),_0x3d684d(0x1a6),_0x3d684d(0x1db),_0x3d684d(0x1a8),_0x3d684d(0x18d),_0x3d684d(0x201),_0x3f99bc(0x1c4),_0x3d684d(0x1b1),_0x3d684d(0x1a3),_0x3d684d(0x144),_0x3d684d(0x193),_0x3d684d(0x1d9),_0x3d684d(0x1c5),_0x3d684d(0x1dd),_0x3d684d(0x184),_0x3d684d(0x1a4),_0x3d684d(0x1d2),_0x3d684d(0x1a1),_0x3d684d(0x1b9),_0x3d684d(0x1e0),_0x3d684d(0x15a),_0x3d684d(0x19d),_0x3d684d(0x1cb),_0x3d684d(0x1f7),'rechargeType',_0x3d684d(0x1c0),_0x3d684d(0x1d6),_0x3d684d(0x1ed),_0x3d684d(0x19e),_0x3d684d(0x1d3),_0x3d684d(0x16f),_0x3d684d(0x1bd),_0x3d684d(0x177),_0x3d684d(0x1f5),_0x3d684d(0x1ac),_0x3d684d(0x179),_0x3d684d(0x13d),_0x3d684d(0x1ce),_0x3d684d(0x1f6),_0x3d684d(0x1b3),_0x3d684d(0x17b),_0x3f99bc(0x21b),_0x3d684d(0x1d4),'salesService',_0x3d684d(0x1aa),_0x3d684d(0x153),_0x3d684d(0x1c2),_0x3d684d(0x180),_0x3f99bc(0x1cc),_0x3d684d(0x1e1),_0x3d684d(0x1fb),_0x3d684d(0x188),_0x3d684d(0x17d),_0x3f99bc(0x1e2),_0x3d684d(0x16e),_0x3d684d(0x14f),'PAYMENT_REQUIRED',_0x3d684d(0x1be),_0x3d684d(0x15d),_0x3d684d(0x167),'874445RmHKtN',_0x3d684d(0x189),_0x3f99bc(0x204),_0x3d684d(0x16a),_0x3f99bc(0x192),_0x3f99bc(0x1ac),_0x3d684d(0x1e4),_0x3d684d(0x1f2),_0x3d684d(0x196),_0x3d684d(0x1af),_0x3d684d(0x1b0),_0x3f99bc(0x1a4),_0x3d684d(0x1c4),'REFER_GIFT',_0x3d684d(0x15e),'findOne',_0x3d684d(0x1cc),_0x3d684d(0x139),_0x3d684d(0x18e),_0x3d684d(0x166),_0x3f99bc(0x17f),_0x3f99bc(0x1ec),_0x3d684d(0x202),_0x3f99bc(0x1da),_0x3d684d(0x160),_0x3d684d(0x1e2),_0x3d684d(0x1c1),_0x3d684d(0x1df),_0x3f99bc(0x1f1),_0x3d684d(0x1ae),_0x3d684d(0x15b),_0x3d684d(0x13e),_0x3d684d(0x17a),'expirationTime'];return _0x2f8d=function(){return _0x573925;},_0x2f8d();}let UserBalanceService=class UserBalanceService{constructor(_0x3da92d,_0x1f4d16,_0x3608f4,_0x5ad7dc,_0x48f89c,_0x3a6622,_0x4d0978,_0x3a6e5f,_0x39d62f,_0x57255c,_0x19d3d1,_0x528dfa,_0x43acad,_0x9918e0){const _0x215a7c=_0x410a14,_0x4ba66e=_0x456bd4;this[_0x4ba66e(0x17f)]=_0x3da92d,this[_0x215a7c(0x1a9)]=_0x1f4d16,this[_0x4ba66e(0x1dc)]=_0x3608f4,this[_0x4ba66e(0x126)]=_0x5ad7dc,this[_0x4ba66e(0x168)]=_0x48f89c,this[_0x4ba66e(0x128)]=_0x3a6622,this[_0x4ba66e(0x18e)]=_0x4d0978,this[_0x4ba66e(0x149)]=_0x3a6e5f,this[_0x4ba66e(0x15d)]=_0x39d62f,this[_0x4ba66e(0x15c)]=_0x57255c,this[_0x4ba66e(0x1af)]=_0x19d3d1,this[_0x215a7c(0x1ba)]=_0x528dfa,this[_0x4ba66e(0x160)]=_0x43acad,this[_0x4ba66e(0x137)]=_0x9918e0;}async[_0x456bd4(0x1b5)](_0x220107,_0x25d0c4){const _0x2ddfba=_0xfd8603,_0x41b691=_0x410a14,_0x157cc5=_0x456bd4;try{const _0x417ab1=await this[_0x41b691(0x188)][_0x41b691(0x160)]({'where':{'configKey':(0x0,typeorm_2['In'])([_0x157cc5(0x19b),_0x157cc5(0x166),_0x157cc5(0x19a),_0x41b691(0x1b7),_0x157cc5(0x1ab),_0x41b691(0x144),_0x157cc5(0x19c),_0x157cc5(0x13b),_0x2ddfba(0x1c8),_0x157cc5(0x1b8),_0x41b691(0x145),_0x157cc5(0x1a6),_0x157cc5(0x148),_0x157cc5(0x190),_0x41b691(0x190),_0x157cc5(0x196)])}}),_0x22c0d2=_0x417ab1[_0x157cc5(0x179)]((_0x35e26b,_0x394f73)=>{const _0x1b55f8=_0x157cc5,_0x27d7d1=Number(_0x394f73[_0x1b55f8(0x161)]),_0x5165d7=Number[_0x1b55f8(0x139)](_0x27d7d1)&&_0x27d7d1>0x0?_0x27d7d1:0x0;return _0x35e26b[_0x394f73[_0x1b55f8(0x1a3)]]=_0x5165d7,_0x35e26b;},{});let _0x2d8d90=0x0,_0xf8bcc9=0x0,_0x831ecb=0x0;_0x22c0d2[_0x157cc5(0x19b)]===0x1&&(_0x2d8d90=_0x2d8d90+_0x22c0d2[_0x2ddfba(0x17a)],_0xf8bcc9=_0xf8bcc9+_0x22c0d2[_0x157cc5(0x19a)],_0x831ecb=_0x831ecb+_0x22c0d2[_0x157cc5(0x12e)]),_0x22c0d2[_0x157cc5(0x19b)]===0x1&&_0x22c0d2[_0x41b691(0x157)]===0x1&&_0x220107<=_0x22c0d2[_0x157cc5(0x13e)]&&(_0x2d8d90=_0x2d8d90+_0x22c0d2[_0x157cc5(0x19c)],_0xf8bcc9=_0xf8bcc9+_0x22c0d2[_0x157cc5(0x13b)],_0x831ecb=_0x831ecb+_0x22c0d2[_0x41b691(0x148)]),await this[_0x41b691(0x16d)]({'userId':_0x220107,'rechargeType':balance_constant_1[_0x157cc5(0x1bf)][_0x157cc5(0x136)],'model3Count':_0x2d8d90,'drawMjCount':_0x831ecb,'model4Count':_0xf8bcc9}),_0x25d0c4&&(Number(_0x22c0d2[_0x157cc5(0x1b8)])===0x1&&(_0x2d8d90=_0x2d8d90+Number(_0x22c0d2[_0x157cc5(0x190)]),_0xf8bcc9=_0xf8bcc9+Number(_0x22c0d2[_0x157cc5(0x196)]),_0x831ecb=_0x831ecb+Number(_0x22c0d2[_0x41b691(0x190)]),await this[_0x157cc5(0x1b2)]({'userId':_0x220107,'rechargeType':balance_constant_1[_0x157cc5(0x1bf)][_0x157cc5(0x131)],'model3Count':_0x22c0d2[_0x157cc5(0x190)],'model4Count':_0x22c0d2[_0x157cc5(0x196)],'drawMjCount':_0x22c0d2[_0x2ddfba(0x1e7)]}),await this[_0x157cc5(0x120)](_0x25d0c4,{'model3Count':_0x22c0d2[_0x157cc5(0x198)],'model4Count':_0x22c0d2[_0x2ddfba(0x1ee)],'drawMjCount':_0x22c0d2[_0x157cc5(0x148)]}),await this[_0x41b691(0x16d)]({'userId':_0x25d0c4,'rechargeType':balance_constant_1[_0x157cc5(0x1bf)][_0x157cc5(0x17e)],'model3Count':_0x22c0d2[_0x41b691(0x145)],'model4Count':_0x22c0d2[_0x157cc5(0x1a6)],'drawMjCount':_0x22c0d2[_0x157cc5(0x148)]}))),await this[_0x157cc5(0x134)][_0x41b691(0x1a4)]({'userId':_0x220107,'model3Count':_0x2d8d90,'model4Count':_0xf8bcc9,'drawMjCount':_0x831ecb,'useTokens':0x0});}catch(_0x207228){console[_0x41b691(0x176)](_0x41b691(0x1cc),_0x207228);throw new common_1[(_0x157cc5(0x1c2))](_0x157cc5(0x133),common_1[_0x2ddfba(0x21f)][_0x157cc5(0x1a9)]);}}async[_0x456bd4(0x124)](_0x1bb1e6,_0x2b2d6a,_0xa9a3e7){const _0x36f197=_0xfd8603,_0x4d3f2b=_0x410a14,_0x1a413c=_0x456bd4,{id:_0x317795,role:_0x1b13a5}=_0x1bb1e6[_0x1a413c(0x186)];let _0xf45e4f=await this[_0x36f197(0x1e5)][_0x1a413c(0x180)]({'where':{'userId':_0x317795}});!_0xf45e4f&&(_0xf45e4f=await this[_0x1a413c(0x1dd)](_0x317795));if(_0x1b13a5===_0x1a413c(0x1a5))return this[_0x1a413c(0x170)](_0x1bb1e6,_0x2b2d6a,_0xa9a3e7);const _0x31e2f1=await this[_0x1a413c(0x168)][_0x1a413c(0x180)]({'where':{'configKey':_0x1a413c(0x155)}}),_0x3f1a1f=_0x31e2f1?_0x31e2f1[_0x1a413c(0x161)]:_0x1a413c(0x185),_0x3da76a=_0x2b2d6a===_0x1a413c(0x150)?_0x1a413c(0x1c6):_0x2b2d6a===_0x1a413c(0x19e)?_0x1a413c(0x1d5):_0x2b2d6a===_0x1a413c(0x153)?_0x1a413c(0x175):null,_0x111949=_0x2b2d6a===_0x4d3f2b(0x1ed)?_0x1a413c(0x12b):_0x2b2d6a===_0x1a413c(0x19e)?_0x36f197(0x1e8):_0x2b2d6a===_0x1a413c(0x153)?_0x4d3f2b(0x1bc):null;if(_0xf45e4f[_0x1a413c(0x1a2)]&&_0xf45e4f[_0x3da76a]<_0xa9a3e7){if(_0xf45e4f[_0x111949]<_0xa9a3e7)throw new common_1[(_0x1a413c(0x1c2))](_0x1a413c(0x16f)+_0x3f1a1f+_0x1a413c(0x1c7),common_1[_0x1a413c(0x19d)][_0x1a413c(0x16d)]);}if(!_0xf45e4f[_0x4d3f2b(0x13f)]&&_0xf45e4f[_0x111949]<_0xa9a3e7)throw new common_1[(_0x1a413c(0x1c2))](_0x4d3f2b(0x15d)+_0x3f1a1f+_0x4d3f2b(0x1a7),common_1[_0x1a413c(0x19d)][_0x1a413c(0x16d)]);return _0xf45e4f;}async[_0x456bd4(0x170)](_0x8dedf5,_0x30213e,_0x71240){const _0x33dd67=_0x410a14,_0x5b1987=_0x456bd4,{id:_0xb866e0}=_0x8dedf5[_0x5b1987(0x186)],_0x59bdbd=_0x30213e===_0x5b1987(0x150)?_0x5b1987(0x12b):_0x30213e===_0x33dd67(0x1fe)?_0x33dd67(0x14e):_0x30213e===_0x5b1987(0x153)?_0x5b1987(0x1c0):null,_0x540711=new Date(),_0x56d720=await this[_0x5b1987(0x15d)][_0x5b1987(0x180)]({'where':{'fingerprint':_0xb866e0}}),{visitorModel3Num:_0xd5cd,visitorModel4Num:_0xf737f7,visitorMJNum:_0x176889}=await this[_0x5b1987(0x137)][_0x5b1987(0x127)]([_0x5b1987(0x1df),_0x33dd67(0x1bb),_0x33dd67(0x186)]),_0x41523c={'model3Count':_0xd5cd?Number(_0xd5cd):0x0,'model4Count':_0xf737f7?Number(_0xf737f7):0x0,'drawMjCount':_0x176889?Number(_0x176889):0x0};if(!_0x56d720){const _0x3af9a2={'fingerprint':_0xb866e0,'model3Count':0x0,'model4Count':0x0,'drawMjCount':0x0};_0x3af9a2[_0x59bdbd]=_0x3af9a2[_0x59bdbd]+_0x71240;if(_0x3af9a2[_0x59bdbd]>_0x41523c[_0x59bdbd])throw new common_1[(_0x33dd67(0x1ab))]('今日当前类型免费额度已经使用完毕、建议您注册账户体验更加完整的服务内容！',common_1[_0x5b1987(0x19d)][_0x33dd67(0x1cd)]);else return await this[_0x5b1987(0x15d)][_0x33dd67(0x1a4)](_0x3af9a2),!![];}else{const {model3Count:_0x1fd85c,model4Count:_0x22cd42,drawMjCount:_0x5a7501}=_0x56d720;let _0x46980e={'model3Count':_0x1fd85c,'model4Count':_0x22cd42,'drawMjCount':_0x5a7501};const _0x8af8fa=Number(new Date(_0x56d720[_0x33dd67(0x14b)])),_0x454e0a=this[_0x5b1987(0x1bc)](_0x8af8fa);_0x454e0a?_0x46980e[_0x59bdbd]=_0x46980e[_0x59bdbd]+_0x71240:(_0x46980e={'model3Count':0x0,'model4Count':0x0,'drawMjCount':0x0},_0x46980e[_0x59bdbd]=_0x46980e[_0x59bdbd]+_0x71240);if(_0x46980e[_0x59bdbd]>_0x41523c[_0x59bdbd])throw new common_1[(_0x5b1987(0x1c2))]('今日当前类型免费额度已经使用完毕、建议您注册账户体验更加完整的服务内容！',common_1[_0x5b1987(0x19d)][_0x5b1987(0x16d)]);else return await this[_0x5b1987(0x15d)][_0x5b1987(0x1a1)]({'fingerprint':_0xb866e0},_0x46980e),!![];}}[_0xfd8603(0x19f)](_0x3e3f1c){const _0x253b60=_0x456bd4,_0x1a62ac=new Date(),_0x1f4a16=new Date(_0x1a62ac[_0x253b60(0x174)](),_0x1a62ac[_0x253b60(0x1d1)](),_0x1a62ac[_0x253b60(0x129)]());return _0x3e3f1c>=_0x1f4a16;}async[_0x410a14(0x181)](_0x2b8641,_0x83925a,_0x194cd4,_0x33ec89=0x0){const _0x37b3fb=_0xfd8603,_0x56b351=_0x410a14,_0x37b8a6=_0x456bd4,_0x41959a=await this[_0x37b8a6(0x134)][_0x37b8a6(0x180)]({'where':{'userId':_0x2b8641}});if(!_0x41959a)throw new common_1[(_0x37b8a6(0x1c2))](_0x37b8a6(0x14b),common_1[_0x37b8a6(0x19d)][_0x37b8a6(0x1a9)]);const _0x3fd001=_0x83925a===_0x37b8a6(0x150)?_0x37b8a6(0x1c6):_0x83925a===_0x37b8a6(0x19e)?_0x37b8a6(0x1d5):_0x83925a===_0x56b351(0x16f)?_0x37b8a6(0x175):null,_0x4b3116=_0x83925a===_0x37b8a6(0x150)?_0x37b3fb(0x1aa):_0x83925a===_0x37b8a6(0x19e)?_0x37b8a6(0x1c1):_0x83925a===_0x56b351(0x16f)?_0x37b8a6(0x1c0):null,_0x4bd274=_0x41959a[_0x37b8a6(0x1a2)]&&_0x41959a[_0x3fd001]<_0x194cd4?_0x4b3116:_0x41959a[_0x37b8a6(0x1a2)]?_0x3fd001:_0x4b3116;let _0x5ccffd=null;_0x4bd274[_0x37b8a6(0x14c)](_0x37b8a6(0x1d8))&&(_0x5ccffd=_0x37b8a6(0x164)),_0x4bd274[_0x37b8a6(0x14c)](_0x56b351(0x1f8))&&(_0x5ccffd=_0x37b8a6(0x140)),_0x4bd274[_0x37b8a6(0x14c)](_0x56b351(0x1e6))&&(_0x5ccffd=_0x37b8a6(0x13d));const _0x530f8f={[_0x4bd274]:_0x41959a[_0x4bd274]-_0x194cd4<0x0?0x0:_0x41959a[_0x4bd274]-_0x194cd4,[_0x5ccffd]:_0x41959a[_0x5ccffd]+_0x33ec89};_0x5ccffd===_0x37b8a6(0x164)&&(_0x530f8f[_0x37b8a6(0x1d2)]=_0x41959a[_0x56b351(0x19c)]+_0x194cd4),_0x5ccffd===_0x56b351(0x1d9)&&(_0x530f8f[_0x37b8a6(0x163)]=_0x41959a[_0x37b8a6(0x163)]+_0x194cd4);const _0x13f964=await this[_0x37b8a6(0x134)][_0x37b8a6(0x1a1)]({'userId':_0x2b8641},_0x530f8f);if(_0x13f964[_0x37b8a6(0x169)]===0x0)throw new common_1[(_0x37b8a6(0x1c2))](_0x37b8a6(0x125),common_1[_0x56b351(0x194)][_0x37b8a6(0x1a9)]);}async[_0x456bd4(0x12c)](_0x2ddd88){const _0xafb589=_0xfd8603,_0x815983=_0x410a14,_0x32cde8=_0x456bd4;try{const _0x3f6a80=await this[_0x32cde8(0x134)][_0x32cde8(0x180)]({'where':{'userId':_0x2ddd88},'select':[_0xafb589(0x1b4),_0x32cde8(0x12b),_0x32cde8(0x1c1),_0x32cde8(0x1c0),_0x32cde8(0x1c6),_0x32cde8(0x1d5),_0x32cde8(0x175),_0x32cde8(0x1d2),_0x32cde8(0x163),_0x32cde8(0x164),_0x32cde8(0x140),_0x32cde8(0x13d),_0x32cde8(0x192)]});if(!_0x3f6a80){const _0x4d252a=await this[_0x815983(0x1e9)](_0x2ddd88);if(_0x4d252a)return await this[_0x32cde8(0x12c)](_0x2ddd88);else throw new common_1[(_0x815983(0x1ab))](_0x32cde8(0x1b6),common_1[_0x815983(0x194)][_0x32cde8(0x1a9)]);}return _0x3f6a80[_0x32cde8(0x142)]=_0x3f6a80[_0x32cde8(0x1a2)]?_0x3f6a80[_0x32cde8(0x12b)]+_0x3f6a80[_0x32cde8(0x1c6)]:_0x3f6a80[_0x32cde8(0x12b)],_0x3f6a80[_0xafb589(0x193)]=_0x3f6a80[_0x32cde8(0x1a2)]?_0x3f6a80[_0x32cde8(0x1c1)]+_0x3f6a80[_0x32cde8(0x1d5)]:_0x3f6a80[_0x815983(0x14e)],_0x3f6a80[_0xafb589(0x1f0)]=_0x3f6a80['packageId']?_0x3f6a80[_0x32cde8(0x1c0)]+_0x3f6a80[_0x815983(0x1fa)]:_0x3f6a80[_0x32cde8(0x1c0)],_0x3f6a80[_0x32cde8(0x192)]=_0x3f6a80['expirationTime']?(0x0,date_1[_0x32cde8(0x1bb)])(_0x3f6a80[_0x815983(0x143)],_0x32cde8(0x1c8)):null,_0x3f6a80;}catch(_0x319415){console[_0xafb589(0x21e)](_0xafb589(0x1f2),_0x319415);}}async[_0x456bd4(0x1b2)](_0x3355fb){const _0xb06896=_0x410a14,_0x3d1694=_0x456bd4,{userId:_0x1978b0,rechargeType:_0x378d02,model3Count:_0x3e3eb1,model4Count:_0x56291b,drawMjCount:_0x5a776e,days:days=-0x1,pkgName:pkgName='',extent:extent=''}=_0x3355fb;if(!_0x1978b0)throw new common_1[(_0x3d1694(0x1c2))](_0x3d1694(0x1c9),common_1[_0x3d1694(0x19d)][_0x3d1694(0x1a9)]);const _0x3c7063=(0x0,utils_1[_0x3d1694(0x1cf)])();return await this[_0xb06896(0x156)][_0x3d1694(0x144)]({'userId':_0x1978b0,'rechargeType':_0x378d02,'model3Count':_0x3e3eb1,'model4Count':_0x56291b,'drawMjCount':_0x5a776e,'days':days,'extent':extent,'uid':_0x3c7063,'pkgName':pkgName});}async[_0x456bd4(0x1dd)](_0x4d047d,_0x409ff0={}){const _0x1d6a78=_0xfd8603,_0x55549d=_0x456bd4,{model3Count:model3Count=0x0,model4Count:model4Count=0x0,drawMjCount:drawMjCount=0x0}=_0x409ff0,_0x4dcadf=await this[_0x55549d(0x134)][_0x55549d(0x180)]({'where':{'userId':_0x4d047d}});if(_0x4dcadf)throw new common_1[(_0x55549d(0x1c2))](_0x1d6a78(0x1b5),common_1[_0x55549d(0x19d)][_0x55549d(0x1a9)]);return await this[_0x55549d(0x134)][_0x1d6a78(0x1e6)]({'userId':_0x4d047d,'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount});}async[_0x456bd4(0x120)](_0xc99175,_0x343d6b,_0x4cfdc3=-0x1){const _0xab15b4=_0xfd8603,_0x464291=_0x410a14,_0x6ddfb9=_0x456bd4;try{const _0x112688=await this[_0x6ddfb9(0x134)][_0x6ddfb9(0x180)]({'where':{'userId':_0xc99175}})||await this[_0x6ddfb9(0x1dd)](_0xc99175);if(!_0x112688)throw new common_1[(_0x6ddfb9(0x1c2))](_0x6ddfb9(0x176),common_1[_0x6ddfb9(0x19d)][_0x464291(0x14a)]);const {model3Count:_0x351886,model4Count:_0x1dbc92,drawMjCount:_0x57a94a,memberModel3Count:_0x52590a,memberModel4Count:_0x555d07,memberDrawMjCount:_0x5992bb}=_0x112688;let _0x5e7ded={};if(_0x4cfdc3>0x0){const {packageId:_0x113e0e}=_0x343d6b;if(!_0x113e0e)throw new common_1[(_0x464291(0x1ab))](_0x6ddfb9(0x18d),common_1[_0x6ddfb9(0x19d)][_0x464291(0x14a)]);const _0x1ae7be=await this[_0x6ddfb9(0x126)][_0x6ddfb9(0x180)]({'where':{'id':_0x113e0e}});if(!_0x1ae7be)throw new common_1[(_0x6ddfb9(0x1c2))](_0x6ddfb9(0x14e),common_1[_0xab15b4(0x21f)][_0x6ddfb9(0x1a9)]);const {weight:_0x5ecf2d}=_0x1ae7be;if(!_0x112688[_0x6ddfb9(0x1a2)])_0x5e7ded={'memberModel3Count':_0x351886+_0x343d6b[_0x6ddfb9(0x12b)],'memberModel4Count':_0x1dbc92+_0x343d6b[_0x6ddfb9(0x1c1)],'memberDrawMjCount':_0x57a94a+_0x343d6b[_0x6ddfb9(0x1c0)],'expirationTime':(0x0,date_1[_0x6ddfb9(0x188)])()[_0x464291(0x139)](_0x4cfdc3>0x0?_0x4cfdc3:0x0,_0x6ddfb9(0x12f))[_0x6ddfb9(0x13a)](_0x464291(0x18c)),'packageId':_0x113e0e};else{const _0x1d30a4=await this[_0x6ddfb9(0x126)][_0x6ddfb9(0x180)]({'where':{'id':_0x112688[_0x6ddfb9(0x1a2)]}});_0x5ecf2d>=_0x1d30a4[_0xab15b4(0x1f5)]&&(_0x5e7ded={'memberModel3Count':_0x52590a+_0x343d6b[_0x6ddfb9(0x12b)],'memberModel4Count':_0x555d07+_0x343d6b[_0x6ddfb9(0x1c1)],'memberDrawMjCount':_0x5992bb+_0x343d6b[_0x6ddfb9(0x1c0)],'expirationTime':(0x0,date_1[_0x6ddfb9(0x188)])(_0x112688[_0x6ddfb9(0x192)])[_0x6ddfb9(0x182)](_0x4cfdc3>0x0?_0x4cfdc3:0x0,_0x6ddfb9(0x12f))[_0x6ddfb9(0x13a)](_0x6ddfb9(0x130)),'packageId':_0x113e0e}),_0x5ecf2d<_0x1d30a4[_0x6ddfb9(0x17a)]&&(_0x5e7ded={'memberModel3Count':_0x52590a+_0x343d6b[_0x6ddfb9(0x12b)],'memberModel4Count':_0x555d07+_0x343d6b[_0x6ddfb9(0x1c1)],'memberDrawMjCount':_0x5992bb+_0x343d6b[_0x464291(0x1bc)]});}}_0x4cfdc3<=0x0&&(_0x5e7ded={'model3Count':_0x351886+_0x343d6b[_0x464291(0x154)],'model4Count':_0x1dbc92+_0x343d6b[_0x6ddfb9(0x1c1)],'drawMjCount':_0x57a94a+_0x343d6b[_0x6ddfb9(0x1c0)]});const _0x973a=await this[_0xab15b4(0x1e5)][_0x6ddfb9(0x1a1)]({'userId':_0xc99175},_0x5e7ded);if(_0x973a[_0x6ddfb9(0x169)]===0x0)throw new common_1[(_0x6ddfb9(0x1c2))](_0xc99175+_0x6ddfb9(0x193),common_1[_0x6ddfb9(0x19d)][_0x6ddfb9(0x1a9)]);}catch(_0x3407b9){console[_0x464291(0x176)](_0x6ddfb9(0x181),_0x3407b9);throw new common_1[(_0x6ddfb9(0x1c2))](_0x6ddfb9(0x1c5),common_1[_0x6ddfb9(0x19d)][_0x6ddfb9(0x1a9)]);}}async[_0x456bd4(0x1b1)](_0xd92153){const _0x12d98b=_0x410a14,_0x2a4bec=_0x456bd4;console[_0x2a4bec(0x197)](_0x2a4bec(0x145),_0xd92153);try{const {userId:_0x3ca7eb,goodsId:_0x4af658}=_0xd92153,_0xa4db82=await this[_0x2a4bec(0x126)][_0x2a4bec(0x180)]({'where':{'id':_0xd92153[_0x2a4bec(0x17c)],'status':0x1}});if(!_0xa4db82)throw new common_1[(_0x2a4bec(0x1c2))](_0x12d98b(0x1d1),common_1[_0x12d98b(0x194)][_0x2a4bec(0x1a9)]);const {model3Count:_0x4c7276,model4Count:_0x9c2a33,drawMjCount:_0xc3cf90,days:_0x435fb6,name:_0x211df9}=_0xa4db82,_0x530c99={'model3Count':_0x4c7276,'model4Count':_0x9c2a33,'drawMjCount':_0xc3cf90,'days':_0x435fb6,'packageId':_0xd92153[_0x2a4bec(0x17c)]};await this[_0x2a4bec(0x120)](_0x3ca7eb,_0x530c99,_0x435fb6),await this[_0x2a4bec(0x1b2)]({'userId':_0x3ca7eb,'rechargeType':balance_constant_1[_0x2a4bec(0x1bf)][_0x12d98b(0x178)],'model3Count':_0x4c7276,'model4Count':_0x9c2a33,'drawMjCount':_0xc3cf90,'pkgName':_0x211df9,'days':_0x435fb6});const _0x50fa6f=await this[_0x2a4bec(0x128)][_0x12d98b(0x150)]({'where':{'id':_0x3ca7eb}}),{invitedBy:_0x37680e}=_0x50fa6f;if(_0x37680e){const _0x379328=await this[_0x2a4bec(0x128)][_0x12d98b(0x150)]({'where':{'inviteCode':_0x37680e}}),_0x40850e=await this[_0x2a4bec(0x18e)][_0x2a4bec(0x180)]({'where':{'userId':_0x379328['id']}});if(!_0x379328)return;const {id:_0x3bb2f7}=_0x379328,{performanceRatio:_0x1bebe4}=_0x40850e,_0x360129={'inviterUserId':_0x3bb2f7,'inviteeUserId':_0x3ca7eb,'orderId':_0xd92153['id'],'orderPrice':_0xd92153[_0x2a4bec(0x146)],'commissionPercentage':_0x1bebe4,'commissionAmount':(_0xd92153[_0x2a4bec(0x146)]*_0x1bebe4/0x64)[_0x2a4bec(0x156)](0x2)};await this[_0x12d98b(0x147)][_0x2a4bec(0x1a4)](_0x360129),await this[_0x12d98b(0x147)][_0x2a4bec(0x16a)](_0x3bb2f7,_0x360129[_0x2a4bec(0x1cc)]);}}catch(_0x276b8c){console[_0x2a4bec(0x197)](_0x12d98b(0x1cc),_0x276b8c);throw new common_1[(_0x12d98b(0x1ab))](_0x2a4bec(0x151),common_1[_0x2a4bec(0x19d)][_0x2a4bec(0x1a9)]);}}async[_0x410a14(0x182)](_0x19aa80,_0x7f33){const _0x44288c=_0x410a14,_0x19ea91=_0x456bd4,{page:page=0x1,size:size=0x14}=_0x7f33,{id:_0x240876}=_0x19aa80[_0x44288c(0x1b5)],[_0x351390,_0x188e14]=await this[_0x19ea91(0x1dc)][_0x19ea91(0x13f)]({'where':{'userId':_0x240876},'order':{'id':_0x19ea91(0x17b)},'skip':(page-0x1)*size,'take':size});return _0x351390[_0x44288c(0x14f)](_0x5ed964=>{const _0x303d83=_0x19ea91;_0x5ed964[_0x303d83(0x18f)]=_0x5ed964[_0x303d83(0x1d4)]>0x0?_0x5ed964[_0x303d83(0x1d4)]+'天':'永久';}),{'rows':(0x0,date_1[_0x19ea91(0x16e)])(_0x351390),'count':_0x188e14};}async[_0x456bd4(0x1de)](_0x3ba7c9,_0x48402e){const _0x2b4f96=_0xfd8603,_0x53ce65=_0x410a14,_0x3ad7c3=_0x456bd4;try{const {page:page=0x1,size:size=0xa,userId:_0x2ac5f9,rechargeType:_0x22e912,packageId:_0x563c7f}=_0x48402e,{role:_0x86505e}=_0x3ba7c9[_0x3ad7c3(0x186)],_0x524302={};_0x22e912&&(_0x524302[_0x3ad7c3(0x14d)]=_0x22e912),_0x524302[_0x3ad7c3(0x178)]=_0x2ac5f9||(0x0,typeorm_2[_0x3ad7c3(0x1e1)])(0x186a0),_0x563c7f&&(_0x524302[_0x3ad7c3(0x1a2)]={'$like':'%'+_0x563c7f+'%'});const [_0x19c0af,_0x5d0aeb]=await this[_0x3ad7c3(0x1dc)][_0x3ad7c3(0x13f)]({'where':_0x524302,'order':{'id':_0x3ad7c3(0x17b)},'skip':(page-0x1)*size,'take':size}),_0xfe0329=_0x19c0af[_0x2b4f96(0x213)](_0x32e130=>_0x32e130[_0x3ad7c3(0x178)]),_0x38f4cd=await this[_0x3ad7c3(0x128)][_0x3ad7c3(0x189)]({'where':{'id':(0x0,typeorm_2['In'])(_0xfe0329)}});return _0x19c0af[_0x53ce65(0x14f)](_0x213191=>{const _0x333fe4=_0x2b4f96,_0x3afaf8=_0x53ce65,_0x2752f9=_0x3ad7c3,_0x24f93a=_0x38f4cd[_0x2752f9(0x189)](_0x232e75=>_0x232e75['id']===_0x213191[_0x2752f9(0x178)]);_0x213191[_0x2752f9(0x158)]=_0x24f93a===null||_0x24f93a===void 0x0?void 0x0:_0x24f93a[_0x2752f9(0x158)],_0x213191[_0x2752f9(0x177)]=_0x24f93a===null||_0x24f93a===void 0x0?void 0x0:_0x24f93a[_0x3afaf8(0x1e4)],_0x213191[_0x2752f9(0x18a)]=_0x24f93a===null||_0x24f93a===void 0x0?void 0x0:_0x24f93a[_0x2752f9(0x18a)],_0x213191[_0x2752f9(0x1bd)]=_0x24f93a===null||_0x24f93a===void 0x0?void 0x0:_0x24f93a[_0x3afaf8(0x18b)],_0x213191[_0x3afaf8(0x17c)]=_0x24f93a===null||_0x24f93a===void 0x0?void 0x0:_0x24f93a[_0x333fe4(0x1bc)];}),_0x86505e!==_0x3ad7c3(0x159)&&_0x19c0af[_0x3ad7c3(0x16c)](_0x16d532=>{const _0x1e6e9a=_0x2b4f96,_0x4fdb9d=_0x3ad7c3;_0x16d532[_0x4fdb9d(0x177)]=_0x16d532[_0x1e6e9a(0x21d)]?(0x0,utils_1[_0x4fdb9d(0x167)])(_0x16d532[_0x4fdb9d(0x177)]):'',_0x16d532[_0x4fdb9d(0x18a)]=_0x16d532[_0x4fdb9d(0x18a)]?(0x0,utils_1[_0x4fdb9d(0x167)])(_0x16d532['phone']):'';}),{'rows':_0x19c0af,'count':_0x5d0aeb};}catch(_0x5ea366){console[_0x3ad7c3(0x197)](_0x3ad7c3(0x181),_0x5ea366);throw new common_1[(_0x2b4f96(0x20c))](_0x3ad7c3(0x1da),common_1[_0x2b4f96(0x21f)][_0x3ad7c3(0x1a9)]);}}async[_0x456bd4(0x13c)](_0x318713){const _0x13488c=_0x456bd4;return await this[_0x13488c(0x134)][_0x13488c(0x189)]({'where':{'userId':(0x0,typeorm_2['In'])(_0x318713)}});}async[_0x456bd4(0x162)](_0x50e734,_0x11220d){const _0x11c549=_0x456bd4;return await this[_0x11c549(0x19f)](_0x50e734,_0x11c549(0x153),-_0x11220d);}async[_0x456bd4(0x143)](){const _0x451f6a=_0x410a14,_0x280bb8=_0x456bd4,_0x38505b=await this[_0x280bb8(0x128)][_0x280bb8(0x189)]();if(!_0x38505b[_0x280bb8(0x18b)])return;const _0x35f8be=await this[_0x280bb8(0x137)][_0x280bb8(0x127)]([_0x280bb8(0x1ba)]);if(!_0x35f8be)await this[_0x280bb8(0x137)][_0x451f6a(0x13c)]({'settings':[{'configKey':_0x280bb8(0x1ba),'configVal':'1'}]});else throw new common_1[(_0x280bb8(0x1c2))](_0x280bb8(0x1d6),common_1[_0x280bb8(0x19d)][_0x280bb8(0x1a9)]);_0x38505b[_0x280bb8(0x16c)](_0x53e83=>{const _0x23e88e=_0x280bb8,{id:_0x472004}=_0x53e83;this[_0x23e88e(0x17f)][_0x23e88e(0x180)]({'where':{'userId':_0x472004}})[_0x23e88e(0x1b4)](_0x2ffed0=>{const _0x155e7c=_0x3d8a;if(!_0x2ffed0)return;this[_0x155e7c(0x1ca)](_0x472004,_0x2ffed0);});});}async[_0x456bd4(0x1ac)](_0xee602b,_0x2aad12){const _0x145982=_0x410a14,_0x5edda2=_0x456bd4,{balance:balance=0x0,usesLeft:usesLeft=0x0,paintCount:paintCount=0x0,useTokens:useTokens=0x0,useChats:useChats=0x0,usePaints:usePaints=0x0}=_0x2aad12,_0x128184=await this[_0x5edda2(0x149)][_0x5edda2(0x180)]({'where':{'userId':_0xee602b}}),_0x12401a={'userId':_0xee602b,'model3Count':Number(usesLeft),'model4Count':(_0x128184===null||_0x128184===void 0x0?void 0x0:_0x128184[_0x5edda2(0x1ce)])||0x0,'drawMjCount':Number(balance),'useModel3Count':Number(useChats),'useModel4Count':(_0x128184===null||_0x128184===void 0x0?void 0x0:_0x128184[_0x5edda2(0x1c3)])||0x0,'useDrawMjCount':Number(usePaints),'useModel3Token':Number(useTokens),'useModel4Token':0x0,'useDrawMjToken':0x0},_0x4bb44d=await this[_0x5edda2(0x134)][_0x5edda2(0x180)]({'where':{'userId':_0xee602b}});_0x4bb44d?common_1[_0x5edda2(0x147)][_0x5edda2(0x183)]('用户'+_0xee602b+'账户信息已经存在、迁移无效',_0x5edda2(0x187)):this[_0x5edda2(0x134)][_0x145982(0x1a4)](_0x12401a)[_0x5edda2(0x1b4)](_0xb28f77=>{const _0x372eec=_0x145982,_0xf106a4=_0x5edda2;common_1[_0xf106a4(0x147)][_0xf106a4(0x183)]('用户'+_0xee602b+_0x372eec(0x1fd),_0x372eec(0x202));})[_0x145982(0x192)](_0x39739f=>{const _0x55cbf5=_0x145982,_0x522589=_0x5edda2;console[_0x55cbf5(0x176)](_0x55cbf5(0x1cc),_0x39739f),common_1[_0x522589(0x147)][_0x522589(0x183)]('用户'+_0xee602b+_0x522589(0x1d7),_0x522589(0x187));});}async[_0x456bd4(0x11e)](_0x5db0cd){const _0xba665a=_0xfd8603,_0x45e53f=_0x410a14,_0x2da535=_0x456bd4,{fingerprint:_0x2466e8}=_0x5db0cd[_0x2da535(0x1d3)],{id:_0x200ab8}=_0x5db0cd[_0x45e53f(0x1b5)];return await this[_0x2da535(0x1af)][_0x2da535(0x1a1)]({'userId':Number(_0x2466e8)},{'userId':_0x200ab8}),await this[_0x2da535(0x15c)][_0xba665a(0x224)]({'userId':Number(_0x2466e8)},{'userId':_0x200ab8}),await this[_0x2da535(0x1ca)][_0x45e53f(0x1a0)]({'userId':Number(_0x2466e8)},{'userId':_0x200ab8}),0x1;}async[_0x410a14(0x17e)](_0x5a534c){const _0x15f6e7=_0xfd8603,_0x3fcdc1=_0x456bd4,{fingerprint:_0x473958}=_0x5a534c[_0x15f6e7(0x1d8)],_0x305974=await this[_0x3fcdc1(0x1af)][_0x3fcdc1(0x1ce)]({'where':{'userId':_0x473958}}),_0x3879d7=await this[_0x3fcdc1(0x15c)][_0x3fcdc1(0x1ce)]({'where':{'userId':_0x473958}}),_0x34d41b=await this[_0x3fcdc1(0x1ca)][_0x3fcdc1(0x1ce)]({'where':{'userId':_0x473958}});return _0x305974||_0x3879d7||_0x34d41b||0x0;}};UserBalanceService=__decorate([(0x0,common_1[_0x456bd4(0x121)])(),__param(0x0,(0x0,typeorm_1[_0xfd8603(0x220)])(balance_entity_1[_0x410a14(0x164)])),__param(0x1,(0x0,typeorm_1[_0x410a14(0x1e7)])(userBalance_entity_1[_0x456bd4(0x1d0)])),__param(0x2,(0x0,typeorm_1[_0x410a14(0x1e7)])(accountLog_entity_1['AccountLogEntity'])),__param(0x3,(0x0,typeorm_1[_0x456bd4(0x1c4)])(cramiPackage_entity_1['CramiPackageEntity'])),__param(0x4,(0x0,typeorm_1[_0x456bd4(0x1c4)])(config_entity_1[_0x456bd4(0x132)])),__param(0x5,(0x0,typeorm_1[_0x456bd4(0x1c4)])(user_entity_1[_0x456bd4(0x16b)])),__param(0x6,(0x0,typeorm_1[_0x456bd4(0x1c4)])(salesUsers_entity_1[_0x410a14(0x1f0)])),__param(0x7,(0x0,typeorm_1[_0x410a14(0x1e7)])(whiteList_entity_1[_0x456bd4(0x1b7)])),__param(0x8,(0x0,typeorm_1[_0x456bd4(0x1c4)])(fingerprint_entity_1[_0x456bd4(0x173)])),__param(0x9,(0x0,typeorm_1[_0x456bd4(0x1c4)])(chatGroup_entity_1[_0x456bd4(0x15a)])),__param(0xa,(0x0,typeorm_1[_0x410a14(0x1e7)])(chatLog_entity_1[_0x410a14(0x19f)])),__param(0xb,(0x0,typeorm_1[_0x410a14(0x1e7)])(midjourney_entity_1[_0x456bd4(0x18c)])),__metadata(_0x456bd4(0x12a),[typeorm_2['Repository'],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0xfd8603(0x1b3)],typeorm_2[_0x410a14(0x18a)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],typeorm_2[_0x456bd4(0x1cb)],sales_service_1[_0x456bd4(0x15f)],globalConfig_service_1[_0x456bd4(0x123)]])],UserBalanceService),exports[_0x456bd4(0x1a8)]=UserBalanceService;