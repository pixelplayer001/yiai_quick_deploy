'use strict';const _0x513374=_0x528f;(function(_0x2fa604,_0x3bc052){const _0x536db9=_0x528f,_0x321b17=_0x2fa604();while(!![]){try{const _0x11529c=parseInt(_0x536db9(0x13e))/0x1+-parseInt(_0x536db9(0x169))/0x2*(parseInt(_0x536db9(0x14f))/0x3)+parseInt(_0x536db9(0x14b))/0x4+-parseInt(_0x536db9(0x170))/0x5+parseInt(_0x536db9(0x111))/0x6+-parseInt(_0x536db9(0x16e))/0x7+-parseInt(_0x536db9(0x17d))/0x8;if(_0x11529c===_0x3bc052)break;else _0x321b17['push'](_0x321b17['shift']());}catch(_0x2229b7){_0x321b17['push'](_0x321b17['shift']());}}}(_0x5618,0x53141));const _0x31f519=_0x1bee;function _0x5618(){const _0x1f9f11=['object','uploadFileByAliOssFromUrl','uploadFileByChevereto','key','getUploadType','mjdev','cosRegion','uploadFileByTencentCos','https://cdn.discordapp.com/attachments/1097409128491651135/1169910551275638855/snine_60b5c001b_A_young_girl_smiles_brightly_in_the_pure_blue_f_8a41fe5f-5101-4c1e-b948-a748a0583577.png?ex=65571f1b&is=6544aa1b&hm=b82f2d88224eb7942e24c63a8e519c7693de12a2b96daa0f327dfb8f691b1480&','url','stream','function','get','../globalConfig/globalConfig.service','uploadFileFromUrl','115898XmxmbL','GlobalConfigService','__decorate','endsWith','catch','531706ZyHLOd','toString','493690DQXkuR','/mj/replaceUpload','data','uploadFile','ISDEV','4060809SlCQfu','上传图片失败[Chevereto]','上传图片失败[Chevereto|buffer]\x20-->\x20','UploadService','1102724eOfcDM','aliOssAccessKeyId','globalConfigService','http://172.247.48.137:8000','4484768jcMBhC','mjProxy','getOwnPropertyDescriptor','message','post','then','uploadFileByTencentCosFromUrl','cos-nodejs-sdk-v5','Logger','准备上传文件:\x20','1251876RtFqVD','onModuleInit','base64','请先前往后台配置上传图片的方式','decorate','526126bsammi','Location','createRandomUid','tencent','当前已开启全球加速----------------->','cosSecretKey','image','slice','1pNsdtx','replace','code','append','stream-to-buffer','BAD_REQUEST','cheveretoKey','上传图片失败[Chevereto][url]','tencentCosAcceleratedDomain','uploadFileByCheveretoFromUrl','split','cheveretoUploadPath','cosBucket','上传配置状态\x20-\x20腾讯云:\x20','source','STANDARD','ali\x20开始上传','error','test','HttpStatus','aliyun','getConfigs','上传图片失败[ten]','使用腾讯云COS上传',',\x20阿里云:\x20','HttpException','使用阿里云OSS上传','mjtest.png','getUploadConfig','Chevereto\x20--->\x20res','7483903bTwmDp','__esModule','375409wFAzEL','cosSecretId','put','log','debug','defineProperty','获取图片资源失败、请重新试试吧！','ali-oss','mjProxyUrl','3384570cNqyNd','tencentCos','length','上传失败:\x20','2429696WfsCGc','status','uploadFileByAliOss','removeSpecialCharacters','6nzDKVB','ali','env','tencentCosStatus','上传图片失败[ALI][url]','push',',\x20Chevereto:\x20','8JLCrPg','getBufferFromUrl','design:paramtypes',',\x20类型:\x20'];_0x5618=function(){return _0x1f9f11;};return _0x5618();}(function(_0x2d1b78,_0x5d85c4){const _0x3a302b=_0x528f,_0x15fb61=_0x1bee,_0x10717a=_0x2d1b78();while(!![]){try{const _0x5f1e4f=-parseInt(_0x15fb61(0xe0))/0x1*(parseInt(_0x15fb61(0xe1))/0x2)+parseInt(_0x15fb61(0xe8))/0x3+-parseInt(_0x15fb61(0xde))/0x4+-parseInt(_0x15fb61(0xf2))/0x5+-parseInt(_0x15fb61(0xf0))/0x6+parseInt(_0x15fb61(0x116))/0x7*(-parseInt(_0x15fb61(0xbd))/0x8)+-parseInt(_0x15fb61(0xc8))/0x9*(-parseInt(_0x15fb61(0xd2))/0xa);if(_0x5f1e4f===_0x5d85c4)break;else _0x10717a[_0x3a302b(0x154)](_0x10717a['shift']());}catch(_0xc0c885){_0x10717a[_0x3a302b(0x154)](_0x10717a['shift']());}}}(_0x3f0d,0xb4c10));function _0x1bee(_0x48b038,_0x2cac1e){const _0x2cad04=_0x3f0d();return _0x1bee=function(_0xcd2f92,_0x142b8e){_0xcd2f92=_0xcd2f92-0xbc;let _0x21242f=_0x2cad04[_0xcd2f92];return _0x21242f;},_0x1bee(_0x48b038,_0x2cac1e);}var __decorate=this&&this[_0x31f519(0xc4)]||function(_0x39e7aa,_0x21f14d,_0x37737d,_0x4ca524){const _0x765ce=_0x31f519;var _0x3e948e=arguments[_0x765ce(0xc3)],_0x1f9c71=_0x3e948e<0x3?_0x21f14d:_0x4ca524===null?_0x4ca524=Object[_0x765ce(0x110)](_0x21f14d,_0x37737d):_0x4ca524,_0x424eb4;if(typeof Reflect===_0x765ce(0xe7)&&typeof Reflect[_0x765ce(0x11e)]===_0x765ce(0xf7))_0x1f9c71=Reflect[_0x765ce(0x11e)](_0x39e7aa,_0x21f14d,_0x37737d,_0x4ca524);else{for(var _0x79e7b3=_0x39e7aa[_0x765ce(0xc3)]-0x1;_0x79e7b3>=0x0;_0x79e7b3--)if(_0x424eb4=_0x39e7aa[_0x79e7b3])_0x1f9c71=(_0x3e948e<0x3?_0x424eb4(_0x1f9c71):_0x3e948e>0x3?_0x424eb4(_0x21f14d,_0x37737d,_0x1f9c71):_0x424eb4(_0x21f14d,_0x37737d))||_0x1f9c71;}return _0x3e948e>0x3&&_0x1f9c71&&Object[_0x765ce(0x128)](_0x21f14d,_0x37737d,_0x1f9c71),_0x1f9c71;},__metadata=this&&this[_0x31f519(0xcd)]||function(_0x319cd4,_0xca4270){const _0x1ef1a5=_0x31f519;if(typeof Reflect===_0x1ef1a5(0xe7)&&typeof Reflect[_0x1ef1a5(0xf5)]===_0x1ef1a5(0xf7))return Reflect['metadata'](_0x319cd4,_0xca4270);};Object['defineProperty'](exports,_0x513374(0x13d),{'value':!![]}),exports[_0x31f519(0x119)]=void 0x0;const common_1=require(_0x31f519(0xd9)),TENCENTCOS=require(_0x513374(0x10e)),ALIOSS=require(_0x513374(0x145)),axios_1=require(_0x31f519(0x11b)),streamToBuffer=require(_0x513374(0x122)),utils_1=require('../../common/utils'),globalConfig_service_1=require(_0x31f519(0x123)),FormData=require(_0x31f519(0xda));function _0x528f(_0x122edb,_0x68e2f2){const _0x561806=_0x5618();return _0x528f=function(_0x528fed,_0xfc192e){_0x528fed=_0x528fed-0x10a;let _0x34d934=_0x561806[_0x528fed];return _0x34d934;},_0x528f(_0x122edb,_0x68e2f2);}function _0x3f0d(){const _0x3acc9b=_0x513374,_0x4223aa=[_0x3acc9b(0x17e),_0x3acc9b(0x17f),_0x3acc9b(0x10f),'cos\x20->\x20err:\x20','https://$2','error:\x20',_0x3acc9b(0x112),_0x3acc9b(0x13c),_0x3acc9b(0x16f),_0x3acc9b(0x121),_0x3acc9b(0x178),_0x3acc9b(0x177),'axios','res:\x20',_0x3acc9b(0x136),_0x3acc9b(0x115),_0x3acc9b(0x133),_0x3acc9b(0x123),'putObject',_0x3acc9b(0x162),_0x3acc9b(0x167),'uploadFileByAliOssFromUrl',_0x3acc9b(0x129),'使用Chevereto上传','aliOssStatus',_0x3acc9b(0x143),'https://',_0x3acc9b(0x10d),_0x3acc9b(0x17b),_0x3acc9b(0x14c),_0x3acc9b(0x13a),_0x3acc9b(0x131),_0x3acc9b(0x16a),_0x3acc9b(0x156),_0x3acc9b(0x14a),_0x3acc9b(0x153),_0x3acc9b(0x166),_0x3acc9b(0x16d),_0x3acc9b(0x160),_0x3acc9b(0x149),_0x3acc9b(0x16b),'aliOssRegion',_0x3acc9b(0x113),_0x3acc9b(0x10a),_0x3acc9b(0x175),'error',_0x3acc9b(0x142),'chevereto',_0x3acc9b(0x163),'__metadata',_0x3acc9b(0x11a),_0x3acc9b(0x176),_0x3acc9b(0x117),'TODO->error:\x20\x20','50KoLVYE',_0x3acc9b(0x132),_0x3acc9b(0x137),_0x3acc9b(0x12b),_0x3acc9b(0x17c),'aliOssAccessKeySecret','png','@nestjs/common','form-data',_0x3acc9b(0x14e),_0x3acc9b(0x164),_0x3acc9b(0x118),_0x3acc9b(0x179),_0x3acc9b(0x139),_0x3acc9b(0x11e),_0x3acc9b(0x116),_0x3acc9b(0x158),_0x3acc9b(0x12d),_0x3acc9b(0x119),_0x3acc9b(0x114),_0x3acc9b(0x11b),_0x3acc9b(0x15a),'2665563OZDsTM',_0x3acc9b(0x127),_0x3acc9b(0x15e),'tencentCos','response',_0x3acc9b(0x168),_0x3acc9b(0x138),_0x3acc9b(0x120),'716226KpvSOO',_0x3acc9b(0x146),_0x3acc9b(0x147),_0x3acc9b(0x141),'post','metadata',_0x3acc9b(0x11f),_0x3acc9b(0x165),'default','aliOssBucket',_0x3acc9b(0x17a),_0x3acc9b(0x16c),_0x3acc9b(0x144),_0x3acc9b(0x125),_0x3acc9b(0x134),_0x3acc9b(0x15c),'getBufferFromUrl',_0x3acc9b(0x12a),_0x3acc9b(0x110),'data',_0x3acc9b(0x126),_0x3acc9b(0x15f),_0x3acc9b(0x13f),'ali',_0x3acc9b(0x11d),_0x3acc9b(0x171),'cheveretoStatus','stringify',_0x3acc9b(0x159),_0x3acc9b(0x13b),'uploadFileByTencentCos'];return _0x3f0d=function(){return _0x4223aa;},_0x3f0d();}let UploadService=class UploadService{constructor(_0xf54932){const _0x4a79db=_0x513374;this[_0x4a79db(0x17b)]=_0xf54932;}[_0x31f519(0x115)](){}async[_0x513374(0x173)](_0x23e5e6){const _0x1e168f=_0x513374,_0x195936=_0x31f519,{filename:_0xb22271,originalname:_0x7fb0cd,buffer:_0xfebd6,dir:dir='ai',mimetype:_0x5383b8}=_0x23e5e6,_0xb05bf=_0x5383b8?_0x5383b8[_0x1e168f(0x128)]('/')[0x1]:'',_0x3f4516=_0x7fb0cd||_0xb22271;common_1[_0x195936(0x111)][_0x1e168f(0x142)](_0x195936(0x102)+_0x3f4516+_0x195936(0x10c)+_0xb05bf,_0x1e168f(0x178));const {tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0x195936(0x12b)][_0x195936(0x11f)]([_0x1e168f(0x152),'aliOssStatus',_0x195936(0x10a)]);common_1[_0x195936(0x111)][_0x195936(0xca)](_0x195936(0xd5)+tencentCosStatus+_0x195936(0x11d)+aliOssStatus+_0x1e168f(0x155)+cheveretoStatus,_0x195936(0x119));if(!Number(tencentCosStatus)&&!Number(aliOssStatus)&&!Number(cheveretoStatus))throw new common_1[(_0x1e168f(0x137))](_0x195936(0xe5),common_1['HttpStatus']['BAD_REQUEST']);try{if(Number(tencentCosStatus))return common_1[_0x195936(0x111)]['debug'](_0x1e168f(0x135),_0x195936(0x119)),await this[_0x195936(0x10e)]({'filename':_0x3f4516,'buffer':_0xfebd6,'dir':dir,'fileTyle':_0xb05bf});if(Number(aliOssStatus))return common_1[_0x195936(0x111)][_0x195936(0xca)](_0x195936(0xee),_0x195936(0x119)),await this['uploadFileByAliOss']({'filename':_0x3f4516,'buffer':_0xfebd6,'dir':dir,'fileTyle':_0xb05bf});if(Number(cheveretoStatus)){common_1[_0x195936(0x111)][_0x195936(0xca)](_0x195936(0x126),_0x195936(0x119));const {filename:_0x4d4d35,buffer:_0x55ca59,dir:_0x1692cc}=_0x23e5e6;return await this[_0x195936(0xff)]({'filename':_0x4d4d35,'buffer':_0x55ca59[_0x195936(0x117)](_0x195936(0xc6)),'dir':_0x1692cc,'fileTyle':_0xb05bf});}}catch(_0x21a2e8){common_1[_0x195936(0x111)][_0x195936(0xc9)](_0x195936(0xbe)+_0x21a2e8[_0x195936(0xc7)],_0x195936(0x119));throw _0x21a2e8;}}async[_0x31f519(0xea)](){const _0xcdc5a6=_0x31f519,{tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0xcdc5a6(0x12b)][_0xcdc5a6(0x11f)](['tencentCosStatus',_0xcdc5a6(0x127),_0xcdc5a6(0x10a)]);if(Number(tencentCosStatus))return _0xcdc5a6(0xe4);if(Number(aliOssStatus))return _0xcdc5a6(0x107);if(Number(cheveretoStatus))return _0xcdc5a6(0xcb);}async[_0x31f519(0xed)]({filename:_0x126ef8,url:_0x10e28d,dir:dir='mj'}){const _0x349181=_0x513374,_0x44f757=_0x31f519;dir=process[_0x349181(0x151)][_0x349181(0x174)]?_0x44f757(0x105):dir;const {tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0x44f757(0x12b)][_0x349181(0x133)]([_0x349181(0x152),_0x44f757(0x127),_0x44f757(0x10a)]);if(!Number(tencentCosStatus)&&!Number(aliOssStatus)&&!Number(cheveretoStatus))throw new common_1['HttpException'](_0x44f757(0xe5),common_1[_0x44f757(0x12e)]['BAD_REQUEST']);if(Number(tencentCosStatus))return this[_0x44f757(0x12a)]({'filename':_0x126ef8,'url':_0x10e28d,'dir':dir});if(Number(aliOssStatus)){const _0xdaced8=await this[_0x44f757(0x124)]({'filename':_0x126ef8,'url':_0x10e28d,'dir':dir});return _0xdaced8;}if(Number(cheveretoStatus))return await this[_0x44f757(0xe9)]({'filename':_0x126ef8,'url':_0x10e28d,'dir':dir});}async[_0x513374(0x161)]({filename:_0x4c79e6,buffer:_0x2a4026,dir:_0x1487a2,fileTyle:_0x17ee0c}){const _0x28c743=_0x513374,_0x38d0fd=_0x31f519,{Bucket:_0x2b6c42,Region:_0x455fea,SecretId:_0x4c87cd,SecretKey:_0x16b320}=await this[_0x38d0fd(0x12d)](_0x38d0fd(0xe4));this[_0x28c743(0x148)]=new TENCENTCOS({'SecretId':_0x4c87cd,'SecretKey':_0x16b320,'FileParallelLimit':0xa});try{return new Promise(async(_0x4752cb,_0x34a021)=>{const _0x5d7ffc=_0x28c743,_0x2815ec=_0x38d0fd,_0xee8881=_0x17ee0c||_0x2815ec(0xd8);this[_0x2815ec(0xeb)][_0x2815ec(0x121)]({'Bucket':(0x0,utils_1[_0x2815ec(0xdb)])(_0x2b6c42),'Region':(0x0,utils_1[_0x5d7ffc(0x14e)])(_0x455fea),'Key':_0x1487a2+'/'+(_0x4c79e6||(0x0,utils_1[_0x2815ec(0xdd)])()+'.'+_0x17ee0c),'StorageClass':_0x2815ec(0xe3),'Body':_0x2a4026},async(_0x1c4e5b,_0x20f047)=>{const _0x2fdbf0=_0x5d7ffc,_0x223c2f=_0x2815ec;if(_0x1c4e5b)return console[_0x223c2f(0xf3)](_0x223c2f(0x112),_0x1c4e5b),_0x34a021(_0x1c4e5b);let _0x6cb69b=_0x20f047[_0x223c2f(0xd0)][_0x2fdbf0(0x11f)](/^(http:\/\/|https:\/\/|\/\/|)(.*)/,_0x223c2f(0x113));const {acceleratedDomain:_0x401461}=await this[_0x223c2f(0x12d)](_0x223c2f(0xe4));return _0x401461&&(_0x6cb69b=_0x6cb69b[_0x223c2f(0xf6)](/^(https:\/\/[^/]+)(\/.*)$/,_0x223c2f(0x129)+_0x401461+'$2'),console[_0x223c2f(0xf3)](_0x223c2f(0xce),_0x6cb69b)),_0x4752cb(_0x6cb69b);});});}catch(_0x1daeb1){console[_0x28c743(0x141)](_0x38d0fd(0x114),_0x1daeb1);throw new common_1[(_0x38d0fd(0xd4))](_0x38d0fd(0xfe),common_1[_0x38d0fd(0x12e)][_0x38d0fd(0x120)]);}}async[_0x31f519(0x12a)]({filename:_0x930f0f,url:_0x532911,dir:_0xe1f1c7}){const _0x671346=_0x513374,_0x397dde=_0x31f519,{Bucket:_0x325af2,Region:_0x4c49d8,SecretId:_0x3e617b,SecretKey:_0x2d92e1}=await this[_0x397dde(0x12d)](_0x397dde(0xe4));this[_0x671346(0x148)]=new TENCENTCOS({'SecretId':_0x3e617b,'SecretKey':_0x2d92e1,'FileParallelLimit':0xa});try{const _0x3b2893=await this[_0x397dde(0x12b)][_0x397dde(0x11f)]([_0x397dde(0x10f)])||0x0,_0x4ceeff=await this[_0x397dde(0x100)](_0x532911);return await this[_0x671346(0x161)]({'filename':_0x930f0f,'buffer':_0x4ceeff,'dir':_0xe1f1c7,'fileTyle':''});}catch(_0x21a0e2){console[_0x397dde(0xf3)](_0x397dde(0xd1),_0x21a0e2);throw new common_1[(_0x397dde(0xd4))]('上传图片失败[ten][url]',common_1[_0x397dde(0x12e)]['BAD_REQUEST']);}}async[_0x513374(0x14d)]({filename:_0x328a18,buffer:_0x1211c2,dir:_0x41d935,fileTyle:fileTyle=_0x31f519(0xd8)}){const _0x44db50=_0x513374,_0x353741=_0x31f519,{region:_0xddfe46,bucket:_0x3e3b72,accessKeyId:_0x1ce80d,accessKeySecret:_0x54b2db}=await this[_0x353741(0x12d)](_0x44db50(0x150)),_0x16d711=new ALIOSS({'region':(0x0,utils_1[_0x44db50(0x14e)])(_0xddfe46),'accessKeyId':_0x1ce80d,'accessKeySecret':_0x54b2db,'bucket':(0x0,utils_1[_0x353741(0xdb)])(_0x3e3b72)});try{return console[_0x353741(0xf3)](_0x44db50(0x12e)),new Promise((_0x15d7be,_0x38bef1)=>{const _0x3b0979=_0x44db50,_0x54cbbc=_0x353741;_0x16d711[_0x3b0979(0x140)](_0x41d935+'/'+(_0x328a18||(0x0,utils_1[_0x54cbbc(0xdd)])()+'.'+fileTyle),_0x1211c2)[_0x3b0979(0x10c)](_0x273b3c=>{const _0xf49fbd=_0x54cbbc;_0x15d7be(_0x273b3c[_0xf49fbd(0xcc)]);})[_0x54cbbc(0xc1)](_0x48a602=>{_0x38bef1(_0x48a602);});});}catch(_0x3695da){throw new common_1[(_0x353741(0xd4))]('上传图片失败[ali]',common_1[_0x353741(0x12e)][_0x44db50(0x123)]);}}async[_0x513374(0x15b)]({filename:_0x5bea5d,url:_0x3d0061,dir:_0x5a99f3}){const _0x384ade=_0x513374,_0x12a4bb=_0x31f519,{region:_0x1436a3,bucket:_0x13b3fd,accessKeyId:_0x2897f5,accessKeySecret:_0x9f8089}=await this[_0x12a4bb(0x12d)](_0x12a4bb(0x107)),_0x58bbcd=new ALIOSS({'region':_0x1436a3,'accessKeyId':_0x2897f5,'accessKeySecret':_0x9f8089,'bucket':_0x13b3fd});try{const _0x40c043=await this[_0x12a4bb(0x12b)][_0x12a4bb(0x11f)]([_0x12a4bb(0x10f)])||0x0;if(Number(_0x40c043)===0x1){const _0x2a3af7={'url':_0x3d0061,'cosParams':{'region':_0x1436a3,'bucket':_0x13b3fd,'accessKeyId':_0x2897f5,'accessKeySecret':_0x9f8089},'cosType':_0x12a4bb(0xd3)},_0x36b3fb=await this[_0x12a4bb(0x12b)][_0x384ade(0x133)]([_0x384ade(0x146)])||_0x12a4bb(0xd6),_0x52f220=await axios_1[_0x12a4bb(0xf8)][_0x384ade(0x10b)](_0x36b3fb+_0x12a4bb(0x109),_0x2a3af7);if(!(_0x52f220===null||_0x52f220===void 0x0?void 0x0:_0x52f220[_0x12a4bb(0x103)]))throw new common_1[(_0x12a4bb(0xd4))](_0x12a4bb(0xbf),common_1[_0x12a4bb(0x12e)][_0x12a4bb(0x120)]);return _0x52f220[_0x12a4bb(0x103)];}else{const _0x550def=await this[_0x384ade(0x157)](_0x3d0061);return await this['uploadFileByAliOss']({'filename':_0x5bea5d,'buffer':_0x550def,'dir':_0x5a99f3});}}catch(_0x9fe33b){throw new common_1[(_0x12a4bb(0xd4))](_0x12a4bb(0xbf),common_1[_0x12a4bb(0x12e)][_0x12a4bb(0x120)]);}}async[_0x513374(0x15c)]({filename:filename='',buffer:_0x4b5a67,dir:dir='ai',fileTyle:fileTyle=_0x31f519(0xd8)}){const _0x5e8d36=_0x513374,_0x31899a=_0x31f519;var _0x2a3140;const {key:_0x2ffc63,uploadPath:_0x3ed1e9}=await this[_0x5e8d36(0x13a)](_0x31899a(0xcb));let _0x4f8eb0=_0x3ed1e9[_0x31899a(0xfb)]('/')?_0x3ed1e9[_0x31899a(0x108)](0x0,-0x1):_0x3ed1e9;const _0x37fe58=new FormData();_0x37fe58[_0x5e8d36(0x121)](_0x5e8d36(0x12c),_0x4b5a67),_0x37fe58[_0x31899a(0x118)](_0x5e8d36(0x15d),_0x2ffc63);try{const _0x534022=await axios_1[_0x31899a(0xf8)][_0x31899a(0xf4)](_0x4f8eb0,_0x37fe58,{'headers':{'X-API-Key':_0x2ffc63}});if((_0x534022===null||_0x534022===void 0x0?void 0x0:_0x534022[_0x31899a(0x12c)])===0xc8)return _0x534022[_0x31899a(0x103)][_0x5e8d36(0x11c)][_0x5e8d36(0x163)];else console[_0x5e8d36(0x141)](_0x31899a(0x10d),_0x534022===null||_0x534022===void 0x0?void 0x0:_0x534022[_0x5e8d36(0x172)][_0x31899a(0xef)],_0x534022===null||_0x534022===void 0x0?void 0x0:_0x534022['data'][_0x5e8d36(0x12f)][_0x5e8d36(0x10a)]),common_1[_0x31899a(0x111)][_0x5e8d36(0x12f)](_0x31899a(0xcf),JSON[_0x31899a(0x10b)](_0x534022[_0x31899a(0x103)]));}catch(_0x52ee1d){console['log'](_0x31899a(0x114),_0x52ee1d);throw new common_1[(_0x31899a(0xd4))](_0x31899a(0x11a)+((_0x2a3140=_0x52ee1d[_0x31899a(0xec)])===null||_0x2a3140===void 0x0?void 0x0:_0x2a3140[_0x31899a(0x103)][_0x5e8d36(0x12f)][_0x31899a(0xc7)]),common_1[_0x31899a(0x12e)][_0x31899a(0x120)]);}}async[_0x31f519(0xe9)]({filename:_0x2b25b2,url:_0x1fa7fd,dir:_0x598ff3}){const _0x3f9930=_0x513374,_0x400f4c=_0x31f519;try{const _0x171f7e=await this[_0x400f4c(0x12b)][_0x400f4c(0x11f)]([_0x400f4c(0x10f)])||0x0;if(Number(_0x171f7e)===0x1){const {key:_0x5ea0ad,uploadPath:_0xdcc9e2}=await this[_0x400f4c(0x12d)](_0x400f4c(0xcb));let _0x241fd2=_0xdcc9e2[_0x400f4c(0xfb)]('/')?_0xdcc9e2[_0x400f4c(0x108)](0x0,-0x1):_0xdcc9e2;const _0x827adc={'cosType':_0x400f4c(0xcb),'url':_0x1fa7fd,'cosParams':{'key':_0x5ea0ad,'uploadPath':_0x241fd2}},_0x11d3db=await this[_0x400f4c(0x12b)][_0x400f4c(0x11f)]([_0x400f4c(0xf1)])||_0x400f4c(0xd6),_0x3bc4e3=await axios_1['default'][_0x400f4c(0xf4)](_0x11d3db+_0x400f4c(0x109),_0x827adc);if(!_0x3bc4e3[_0x400f4c(0x103)])throw new common_1[(_0x400f4c(0xd4))](_0x400f4c(0xfd),common_1[_0x400f4c(0x12e)][_0x3f9930(0x123)]);return _0x3bc4e3[_0x400f4c(0x103)];}else{const _0x766dab=await this['getBufferFromUrl'](_0x1fa7fd);return await this[_0x3f9930(0x15c)]({'filename':_0x2b25b2,'buffer':_0x766dab,'dir':_0x598ff3});}}catch(_0x1cabf8){console[_0x400f4c(0xf3)](_0x400f4c(0x114),_0x1cabf8);throw new common_1[(_0x400f4c(0xd4))](_0x1cabf8[_0x400f4c(0xec)],common_1[_0x400f4c(0x12e)][_0x400f4c(0x120)]);}}async[_0x31f519(0x12d)](_0x122275){const _0x2ee3ef=_0x513374,_0x1477d2=_0x31f519;if(_0x122275==='ali'){const {aliOssRegion:_0x28240,aliOssBucket:_0xb7ce77,aliOssAccessKeyId:_0x163aaf,aliOssAccessKeySecret:_0x471ace}=await this[_0x2ee3ef(0x17b)][_0x1477d2(0x11f)]([_0x1477d2(0xc5),_0x1477d2(0xf9),_0x1477d2(0xfa),_0x1477d2(0xd7)]);return{'region':_0x28240,'bucket':_0xb7ce77,'accessKeyId':_0x163aaf,'accessKeySecret':_0x471ace};}if(_0x122275===_0x1477d2(0xe4)){const {cosBucket:_0x2f2a62,cosRegion:_0x21792c,cosSecretId:_0x10535c,cosSecretKey:_0xc93d03,tencentCosAcceleratedDomain:_0x36cf76}=await this[_0x2ee3ef(0x17b)][_0x1477d2(0x11f)]([_0x1477d2(0x101),_0x1477d2(0xc2),_0x1477d2(0x106),_0x1477d2(0xe6),_0x1477d2(0x104)]);return{'Bucket':_0x2f2a62,'Region':_0x21792c,'SecretId':_0x10535c,'SecretKey':_0xc93d03,'acceleratedDomain':_0x36cf76};}if(_0x122275===_0x1477d2(0xcb)){const {cheveretoKey:_0x45225c,cheveretoUploadPath:_0x58aeaf}=await this[_0x1477d2(0x12b)][_0x2ee3ef(0x133)]([_0x2ee3ef(0x124),_0x1477d2(0x125)]);return{'key':_0x45225c,'uploadPath':_0x58aeaf};}}async[_0x513374(0x130)](){const _0x2c0731=_0x31f519,_0x4686ab={'filename':_0x2c0731(0xdf),'dir':'mj','url':_0x2c0731(0x122)},_0x3280d4=await this[_0x2c0731(0xed)](_0x4686ab);return console[_0x2c0731(0xf3)](_0x2c0731(0x11c),_0x3280d4),_0x3280d4;}async[_0x31f519(0x100)](_0x4ebd84){const _0x1cd0f7=_0x31f519,_0x3e48c5=await this[_0x1cd0f7(0x12b)][_0x1cd0f7(0x11f)]([_0x1cd0f7(0x10f)])||0x0,_0x12cd82=await axios_1[_0x1cd0f7(0xf8)][_0x1cd0f7(0xc0)](_0x4ebd84,{'responseType':_0x1cd0f7(0xdc)});return new Promise((_0x1499b1,_0x3a73bc)=>{const _0x7f6fe2=_0x1cd0f7;streamToBuffer(_0x12cd82[_0x7f6fe2(0x103)],(_0x5bb012,_0x5d1b5b)=>{const _0x16675f=_0x7f6fe2;if(_0x5bb012)throw new common_1[(_0x16675f(0xd4))](_0x16675f(0xfc),common_1[_0x16675f(0x12e)][_0x16675f(0x120)]);else _0x1499b1(_0x5d1b5b);});});}};UploadService=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x31f519(0xe2),[globalConfig_service_1[_0x31f519(0xbc)]])],UploadService),exports['UploadService']=UploadService;