'use strict';const _0x207837=_0x6407;(function(_0x2297f4,_0x3f2dda){const _0x33757f=_0x6407,_0x1ce09e=_0x2297f4();while(!![]){try{const _0x4901b5=parseInt(_0x33757f(0x1d4))/0x1+parseInt(_0x33757f(0x1dd))/0x2*(parseInt(_0x33757f(0x1f3))/0x3)+-parseInt(_0x33757f(0x1db))/0x4*(-parseInt(_0x33757f(0x1c6))/0x5)+parseInt(_0x33757f(0x20b))/0x6*(parseInt(_0x33757f(0x1d3))/0x7)+parseInt(_0x33757f(0x22f))/0x8+parseInt(_0x33757f(0x23e))/0x9*(-parseInt(_0x33757f(0x1e5))/0xa)+-parseInt(_0x33757f(0x201))/0xb;if(_0x4901b5===_0x3f2dda)break;else _0x1ce09e['push'](_0x1ce09e['shift']());}catch(_0x5d1c50){_0x1ce09e['push'](_0x1ce09e['shift']());}}}(_0x37ae,0xb20cc));function _0x6407(_0x1e2f1e,_0x153a05){const _0x37ae95=_0x37ae();return _0x6407=function(_0x64073c,_0x3f49d1){_0x64073c=_0x64073c-0x1bd;let _0x3f1166=_0x37ae95[_0x64073c];return _0x3f1166;},_0x6407(_0x1e2f1e,_0x153a05);}const _0x513374=_0x528f;(function(_0x5d5a70,_0x10f482){const _0x5313e2=_0x6407,_0x2d7476=_0x528f,_0x28aeab=_0x5d5a70();while(!![]){try{const _0x19410d=parseInt(_0x2d7476(0x13e))/0x1+-parseInt(_0x2d7476(0x169))/0x2*(parseInt(_0x2d7476(0x14f))/0x3)+parseInt(_0x2d7476(0x14b))/0x4+-parseInt(_0x2d7476(0x170))/0x5+parseInt(_0x2d7476(0x111))/0x6+-parseInt(_0x2d7476(0x16e))/0x7+-parseInt(_0x2d7476(0x17d))/0x8;if(_0x19410d===_0x10f482)break;else _0x28aeab['push'](_0x28aeab[_0x5313e2(0x230)]());}catch(_0x757021){_0x28aeab[_0x5313e2(0x211)](_0x28aeab[_0x5313e2(0x230)]());}}}(_0x5618,0x53141));const _0x31f519=_0x1bee;function _0x5618(){const _0x5520f4=_0x6407,_0x583f07=[_0x5520f4(0x20a),_0x5520f4(0x241),'uploadFileByChevereto',_0x5520f4(0x236),_0x5520f4(0x1c7),_0x5520f4(0x1d0),_0x5520f4(0x1e6),_0x5520f4(0x220),_0x5520f4(0x1e1),_0x5520f4(0x1ca),_0x5520f4(0x228),_0x5520f4(0x237),_0x5520f4(0x1fb),_0x5520f4(0x1fc),_0x5520f4(0x1fa),_0x5520f4(0x1e3),'GlobalConfigService','__decorate',_0x5520f4(0x1cc),_0x5520f4(0x209),_0x5520f4(0x1ed),_0x5520f4(0x1c5),_0x5520f4(0x243),_0x5520f4(0x223),'data',_0x5520f4(0x229),_0x5520f4(0x1be),_0x5520f4(0x1fd),_0x5520f4(0x1d7),_0x5520f4(0x239),'UploadService','1102724eOfcDM',_0x5520f4(0x231),_0x5520f4(0x235),'http://172.247.48.137:8000',_0x5520f4(0x1f5),_0x5520f4(0x244),_0x5520f4(0x232),'message','post',_0x5520f4(0x1f9),'uploadFileByTencentCosFromUrl',_0x5520f4(0x1e2),'Logger',_0x5520f4(0x1cb),_0x5520f4(0x1ec),_0x5520f4(0x1d5),_0x5520f4(0x217),_0x5520f4(0x1c0),_0x5520f4(0x238),_0x5520f4(0x1cd),'Location',_0x5520f4(0x1f6),_0x5520f4(0x225),'当前已开启全球加速----------------->',_0x5520f4(0x20d),_0x5520f4(0x1de),_0x5520f4(0x1df),_0x5520f4(0x222),_0x5520f4(0x208),_0x5520f4(0x1c2),_0x5520f4(0x21b),_0x5520f4(0x21c),_0x5520f4(0x21f),_0x5520f4(0x22d),_0x5520f4(0x200),_0x5520f4(0x1d8),_0x5520f4(0x240),_0x5520f4(0x1ff),_0x5520f4(0x234),_0x5520f4(0x1da),_0x5520f4(0x22b),_0x5520f4(0x1ef),'STANDARD',_0x5520f4(0x210),_0x5520f4(0x1f2),_0x5520f4(0x21a),_0x5520f4(0x20f),_0x5520f4(0x1eb),_0x5520f4(0x1ce),_0x5520f4(0x226),_0x5520f4(0x1e4),_0x5520f4(0x21e),_0x5520f4(0x23b),'使用阿里云OSS上传',_0x5520f4(0x1f8),_0x5520f4(0x1bd),'Chevereto\x20--->\x20res',_0x5520f4(0x1f1),_0x5520f4(0x1c3),_0x5520f4(0x20e),'cosSecretId',_0x5520f4(0x23c),_0x5520f4(0x1f0),_0x5520f4(0x1e9),'defineProperty',_0x5520f4(0x23d),_0x5520f4(0x1d2),_0x5520f4(0x212),_0x5520f4(0x22e),_0x5520f4(0x20c),_0x5520f4(0x1e8),_0x5520f4(0x214),_0x5520f4(0x23f),_0x5520f4(0x242),'uploadFileByAliOss',_0x5520f4(0x1cf),_0x5520f4(0x21d),_0x5520f4(0x215),_0x5520f4(0x1f7),_0x5520f4(0x1c9),'上传图片失败[ALI][url]',_0x5520f4(0x211),_0x5520f4(0x1c1),_0x5520f4(0x224),'getBufferFromUrl',_0x5520f4(0x1c4),_0x5520f4(0x227)];return _0x5618=function(){return _0x583f07;},_0x5618();}(function(_0x2beccf,_0x3da707){const _0x5bab05=_0x6407,_0x2c4f3c=_0x528f,_0x1d3077=_0x1bee,_0xe70814=_0x2beccf();while(!![]){try{const _0x57791d=-parseInt(_0x1d3077(0xe0))/0x1*(parseInt(_0x1d3077(0xe1))/0x2)+parseInt(_0x1d3077(0xe8))/0x3+-parseInt(_0x1d3077(0xde))/0x4+-parseInt(_0x1d3077(0xf2))/0x5+-parseInt(_0x1d3077(0xf0))/0x6+parseInt(_0x1d3077(0x116))/0x7*(-parseInt(_0x1d3077(0xbd))/0x8)+-parseInt(_0x1d3077(0xc8))/0x9*(-parseInt(_0x1d3077(0xd2))/0xa);if(_0x57791d===_0x3da707)break;else _0xe70814[_0x2c4f3c(0x154)](_0xe70814[_0x5bab05(0x230)]());}catch(_0x2faa26){_0xe70814[_0x2c4f3c(0x154)](_0xe70814['shift']());}}}(_0x3f0d,0xb4c10));function _0x1bee(_0x2c2259,_0x6f29b1){const _0x1bc2aa=_0x3f0d();return _0x1bee=function(_0x4ec3de,_0x1dea76){_0x4ec3de=_0x4ec3de-0xbc;let _0x4cf747=_0x1bc2aa[_0x4ec3de];return _0x4cf747;},_0x1bee(_0x2c2259,_0x6f29b1);}var __decorate=this&&this[_0x31f519(0xc4)]||function(_0x577192,_0x2f2500,_0x332309,_0x324f6c){const _0x224c99=_0x31f519;var _0x4ca666=arguments[_0x224c99(0xc3)],_0x2f0a3f=_0x4ca666<0x3?_0x2f2500:_0x324f6c===null?_0x324f6c=Object[_0x224c99(0x110)](_0x2f2500,_0x332309):_0x324f6c,_0x427446;if(typeof Reflect===_0x224c99(0xe7)&&typeof Reflect[_0x224c99(0x11e)]===_0x224c99(0xf7))_0x2f0a3f=Reflect[_0x224c99(0x11e)](_0x577192,_0x2f2500,_0x332309,_0x324f6c);else{for(var _0x2fd178=_0x577192[_0x224c99(0xc3)]-0x1;_0x2fd178>=0x0;_0x2fd178--)if(_0x427446=_0x577192[_0x2fd178])_0x2f0a3f=(_0x4ca666<0x3?_0x427446(_0x2f0a3f):_0x4ca666>0x3?_0x427446(_0x2f2500,_0x332309,_0x2f0a3f):_0x427446(_0x2f2500,_0x332309))||_0x2f0a3f;}return _0x4ca666>0x3&&_0x2f0a3f&&Object[_0x224c99(0x128)](_0x2f2500,_0x332309,_0x2f0a3f),_0x2f0a3f;},__metadata=this&&this[_0x31f519(0xcd)]||function(_0x5df6e0,_0x545c8d){const _0x2ab25f=_0x31f519;if(typeof Reflect===_0x2ab25f(0xe7)&&typeof Reflect[_0x2ab25f(0xf5)]===_0x2ab25f(0xf7))return Reflect['metadata'](_0x5df6e0,_0x545c8d);};Object['defineProperty'](exports,_0x513374(0x13d),{'value':!![]}),exports[_0x31f519(0x119)]=void 0x0;const common_1=require(_0x31f519(0xd9)),TENCENTCOS=require(_0x513374(0x10e)),ALIOSS=require(_0x513374(0x145)),axios_1=require(_0x31f519(0x11b)),streamToBuffer=require(_0x513374(0x122)),utils_1=require(_0x207837(0x22c)),globalConfig_service_1=require(_0x31f519(0x123)),FormData=require(_0x31f519(0xda));function _0x528f(_0x30fdaf,_0x481c10){const _0x2e0deb=_0x5618();return _0x528f=function(_0x5738c1,_0x46529e){_0x5738c1=_0x5738c1-0x10a;let _0x357c69=_0x2e0deb[_0x5738c1];return _0x357c69;},_0x528f(_0x30fdaf,_0x481c10);}function _0x3f0d(){const _0x17c98f=_0x207837,_0x35350e=_0x513374,_0xe37764=[_0x35350e(0x17e),_0x35350e(0x17f),_0x35350e(0x10f),'cos\x20->\x20err:\x20',_0x17c98f(0x233),_0x17c98f(0x213),_0x35350e(0x112),_0x35350e(0x13c),_0x35350e(0x16f),_0x35350e(0x121),_0x35350e(0x178),_0x35350e(0x177),_0x17c98f(0x207),_0x17c98f(0x1fe),_0x35350e(0x136),_0x35350e(0x115),_0x35350e(0x133),_0x35350e(0x123),'putObject',_0x35350e(0x162),_0x35350e(0x167),_0x17c98f(0x241),_0x35350e(0x129),_0x17c98f(0x1d9),_0x17c98f(0x1d6),_0x35350e(0x143),_0x17c98f(0x22a),_0x35350e(0x10d),_0x35350e(0x17b),_0x35350e(0x14c),_0x35350e(0x13a),_0x35350e(0x131),_0x35350e(0x16a),_0x35350e(0x156),_0x35350e(0x14a),_0x35350e(0x153),_0x35350e(0x166),_0x35350e(0x16d),_0x35350e(0x160),_0x35350e(0x149),_0x35350e(0x16b),_0x17c98f(0x206),_0x35350e(0x113),_0x35350e(0x10a),_0x35350e(0x175),_0x17c98f(0x1f2),_0x35350e(0x142),_0x17c98f(0x1e0),_0x35350e(0x163),_0x17c98f(0x23a),_0x35350e(0x11a),_0x35350e(0x176),_0x35350e(0x117),_0x17c98f(0x218),_0x17c98f(0x219),_0x35350e(0x132),_0x35350e(0x137),_0x35350e(0x12b),_0x35350e(0x17c),_0x17c98f(0x203),'png','@nestjs/common',_0x17c98f(0x205),_0x35350e(0x14e),_0x35350e(0x164),_0x35350e(0x118),_0x35350e(0x179),_0x35350e(0x139),_0x35350e(0x11e),_0x35350e(0x116),_0x35350e(0x158),_0x35350e(0x12d),_0x35350e(0x119),_0x35350e(0x114),_0x35350e(0x11b),_0x35350e(0x15a),_0x17c98f(0x1ee),_0x35350e(0x127),_0x35350e(0x15e),_0x17c98f(0x20c),_0x17c98f(0x216),_0x35350e(0x168),_0x35350e(0x138),_0x35350e(0x120),_0x17c98f(0x202),_0x35350e(0x146),_0x35350e(0x147),_0x35350e(0x141),_0x17c98f(0x1bf),_0x17c98f(0x1dc),_0x35350e(0x11f),_0x35350e(0x165),'default','aliOssBucket',_0x35350e(0x17a),_0x35350e(0x16c),_0x35350e(0x144),_0x35350e(0x125),_0x35350e(0x134),_0x35350e(0x15c),_0x17c98f(0x221),_0x35350e(0x12a),_0x35350e(0x110),_0x17c98f(0x1d1),_0x35350e(0x126),_0x35350e(0x15f),_0x35350e(0x13f),_0x17c98f(0x215),_0x35350e(0x11d),_0x35350e(0x171),_0x17c98f(0x204),'stringify',_0x35350e(0x159),_0x35350e(0x13b),_0x17c98f(0x220)];return _0x3f0d=function(){return _0xe37764;},_0x3f0d();}let UploadService=class UploadService{constructor(_0x3b51e4){const _0x275c0b=_0x513374;this[_0x275c0b(0x17b)]=_0x3b51e4;}[_0x31f519(0x115)](){}async[_0x513374(0x173)](_0x3d6684){const _0x526c9f=_0x207837,_0x2d0b2e=_0x513374,_0x3716b8=_0x31f519,{filename:_0x404db2,originalname:_0x2d2fef,buffer:_0x59ca51,dir:dir='ai',mimetype:_0x3a988b}=_0x3d6684,_0x5c1d41=_0x3a988b?_0x3a988b[_0x2d0b2e(0x128)]('/')[0x1]:'',_0x98a93d=_0x2d2fef||_0x404db2;common_1[_0x3716b8(0x111)][_0x2d0b2e(0x142)](_0x3716b8(0x102)+_0x98a93d+_0x3716b8(0x10c)+_0x5c1d41,_0x2d0b2e(0x178));const {tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0x3716b8(0x12b)][_0x3716b8(0x11f)]([_0x2d0b2e(0x152),_0x526c9f(0x1d6),_0x3716b8(0x10a)]);common_1[_0x3716b8(0x111)][_0x3716b8(0xca)](_0x3716b8(0xd5)+tencentCosStatus+_0x3716b8(0x11d)+aliOssStatus+_0x2d0b2e(0x155)+cheveretoStatus,_0x3716b8(0x119));if(!Number(tencentCosStatus)&&!Number(aliOssStatus)&&!Number(cheveretoStatus))throw new common_1[(_0x2d0b2e(0x137))](_0x3716b8(0xe5),common_1[_0x526c9f(0x20f)][_0x526c9f(0x21f)]);try{if(Number(tencentCosStatus))return common_1[_0x3716b8(0x111)]['debug'](_0x2d0b2e(0x135),_0x3716b8(0x119)),await this[_0x3716b8(0x10e)]({'filename':_0x98a93d,'buffer':_0x59ca51,'dir':dir,'fileTyle':_0x5c1d41});if(Number(aliOssStatus))return common_1[_0x3716b8(0x111)][_0x3716b8(0xca)](_0x3716b8(0xee),_0x3716b8(0x119)),await this['uploadFileByAliOss']({'filename':_0x98a93d,'buffer':_0x59ca51,'dir':dir,'fileTyle':_0x5c1d41});if(Number(cheveretoStatus)){common_1[_0x3716b8(0x111)][_0x3716b8(0xca)](_0x3716b8(0x126),_0x3716b8(0x119));const {filename:_0xfab3d6,buffer:_0x1107e1,dir:_0x16582b}=_0x3d6684;return await this[_0x3716b8(0xff)]({'filename':_0xfab3d6,'buffer':_0x1107e1[_0x3716b8(0x117)](_0x3716b8(0xc6)),'dir':_0x16582b,'fileTyle':_0x5c1d41});}}catch(_0x4f8c10){common_1[_0x3716b8(0x111)][_0x3716b8(0xc9)](_0x3716b8(0xbe)+_0x4f8c10[_0x3716b8(0xc7)],_0x3716b8(0x119));throw _0x4f8c10;}}async[_0x31f519(0xea)](){const _0x2e66e2=_0x31f519,{tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0x2e66e2(0x12b)][_0x2e66e2(0x11f)](['tencentCosStatus',_0x2e66e2(0x127),_0x2e66e2(0x10a)]);if(Number(tencentCosStatus))return _0x2e66e2(0xe4);if(Number(aliOssStatus))return _0x2e66e2(0x107);if(Number(cheveretoStatus))return _0x2e66e2(0xcb);}async[_0x31f519(0xed)]({filename:_0x27667f,url:_0x25ea68,dir:dir='mj'}){const _0x303e32=_0x207837,_0x484ddd=_0x513374,_0x5a60ca=_0x31f519;dir=process[_0x484ddd(0x151)][_0x484ddd(0x174)]?_0x5a60ca(0x105):dir;const {tencentCosStatus:tencentCosStatus=0x0,aliOssStatus:aliOssStatus=0x0,cheveretoStatus:cheveretoStatus=0x0}=await this[_0x5a60ca(0x12b)][_0x484ddd(0x133)]([_0x484ddd(0x152),_0x5a60ca(0x127),_0x5a60ca(0x10a)]);if(!Number(tencentCosStatus)&&!Number(aliOssStatus)&&!Number(cheveretoStatus))throw new common_1['HttpException'](_0x5a60ca(0xe5),common_1[_0x5a60ca(0x12e)][_0x303e32(0x21f)]);if(Number(tencentCosStatus))return this[_0x5a60ca(0x12a)]({'filename':_0x27667f,'url':_0x25ea68,'dir':dir});if(Number(aliOssStatus)){const _0x485d82=await this[_0x5a60ca(0x124)]({'filename':_0x27667f,'url':_0x25ea68,'dir':dir});return _0x485d82;}if(Number(cheveretoStatus))return await this[_0x5a60ca(0xe9)]({'filename':_0x27667f,'url':_0x25ea68,'dir':dir});}async[_0x513374(0x161)]({filename:_0x37b76f,buffer:_0x1577bf,dir:_0x5b6b43,fileTyle:_0x349259}){const _0x43ded0=_0x513374,_0x3327f9=_0x31f519,{Bucket:_0x97e010,Region:_0x4f6c7a,SecretId:_0x2cfc8b,SecretKey:_0x2e994f}=await this[_0x3327f9(0x12d)](_0x3327f9(0xe4));this[_0x43ded0(0x148)]=new TENCENTCOS({'SecretId':_0x2cfc8b,'SecretKey':_0x2e994f,'FileParallelLimit':0xa});try{return new Promise(async(_0x5c02db,_0x4be653)=>{const _0x5730d9=_0x43ded0,_0x4f7bb3=_0x3327f9,_0x908f40=_0x349259||_0x4f7bb3(0xd8);this[_0x4f7bb3(0xeb)][_0x4f7bb3(0x121)]({'Bucket':(0x0,utils_1[_0x4f7bb3(0xdb)])(_0x97e010),'Region':(0x0,utils_1[_0x5730d9(0x14e)])(_0x4f6c7a),'Key':_0x5b6b43+'/'+(_0x37b76f||(0x0,utils_1[_0x4f7bb3(0xdd)])()+'.'+_0x349259),'StorageClass':_0x4f7bb3(0xe3),'Body':_0x1577bf},async(_0x3a4155,_0x4a9ba3)=>{const _0x5e8c49=_0x5730d9,_0x27219e=_0x4f7bb3;if(_0x3a4155)return console[_0x27219e(0xf3)](_0x27219e(0x112),_0x3a4155),_0x4be653(_0x3a4155);let _0x8ea6f7=_0x4a9ba3[_0x27219e(0xd0)][_0x5e8c49(0x11f)](/^(http:\/\/|https:\/\/|\/\/|)(.*)/,_0x27219e(0x113));const {acceleratedDomain:_0x48dbb6}=await this[_0x27219e(0x12d)](_0x27219e(0xe4));return _0x48dbb6&&(_0x8ea6f7=_0x8ea6f7[_0x27219e(0xf6)](/^(https:\/\/[^/]+)(\/.*)$/,_0x27219e(0x129)+_0x48dbb6+'$2'),console[_0x27219e(0xf3)](_0x27219e(0xce),_0x8ea6f7)),_0x5c02db(_0x8ea6f7);});});}catch(_0xb8c16c){console[_0x43ded0(0x141)](_0x3327f9(0x114),_0xb8c16c);throw new common_1[(_0x3327f9(0xd4))](_0x3327f9(0xfe),common_1[_0x3327f9(0x12e)][_0x3327f9(0x120)]);}}async[_0x31f519(0x12a)]({filename:_0x14aed2,url:_0x280424,dir:_0x298aa9}){const _0x4c3fe5=_0x207837,_0x3f8117=_0x513374,_0x5dc5da=_0x31f519,{Bucket:_0x5b5db3,Region:_0x4fbdc8,SecretId:_0x1062a3,SecretKey:_0x632bf2}=await this[_0x5dc5da(0x12d)](_0x5dc5da(0xe4));this[_0x3f8117(0x148)]=new TENCENTCOS({'SecretId':_0x1062a3,'SecretKey':_0x632bf2,'FileParallelLimit':0xa});try{const _0x5a1057=await this[_0x5dc5da(0x12b)][_0x5dc5da(0x11f)]([_0x5dc5da(0x10f)])||0x0,_0x37b4a3=await this[_0x5dc5da(0x100)](_0x280424);return await this[_0x3f8117(0x161)]({'filename':_0x14aed2,'buffer':_0x37b4a3,'dir':_0x298aa9,'fileTyle':''});}catch(_0x56f1ff){console[_0x5dc5da(0xf3)](_0x5dc5da(0xd1),_0x56f1ff);throw new common_1[(_0x5dc5da(0xd4))](_0x4c3fe5(0x1ea),common_1[_0x5dc5da(0x12e)][_0x4c3fe5(0x21f)]);}}async[_0x513374(0x14d)]({filename:_0x45bb57,buffer:_0x469a77,dir:_0x36e132,fileTyle:fileTyle=_0x31f519(0xd8)}){const _0xa58df=_0x207837,_0x478b84=_0x513374,_0x211307=_0x31f519,{region:_0x1c8f60,bucket:_0x2859ac,accessKeyId:_0x2b9efd,accessKeySecret:_0x328163}=await this[_0x211307(0x12d)](_0x478b84(0x150)),_0x349a81=new ALIOSS({'region':(0x0,utils_1[_0x478b84(0x14e)])(_0x1c8f60),'accessKeyId':_0x2b9efd,'accessKeySecret':_0x328163,'bucket':(0x0,utils_1[_0x211307(0xdb)])(_0x2859ac)});try{return console[_0x211307(0xf3)](_0x478b84(0x12e)),new Promise((_0x560ff8,_0x1b8955)=>{const _0x34f453=_0x478b84,_0x58d7bb=_0x211307;_0x349a81[_0x34f453(0x140)](_0x36e132+'/'+(_0x45bb57||(0x0,utils_1[_0x58d7bb(0xdd)])()+'.'+fileTyle),_0x469a77)[_0x34f453(0x10c)](_0x4b211f=>{const _0x5965aa=_0x58d7bb;_0x560ff8(_0x4b211f[_0x5965aa(0xcc)]);})[_0x58d7bb(0xc1)](_0x2d26b7=>{_0x1b8955(_0x2d26b7);});});}catch(_0x11f844){throw new common_1[(_0x211307(0xd4))](_0xa58df(0x1e7),common_1[_0x211307(0x12e)][_0x478b84(0x123)]);}}async[_0x513374(0x15b)]({filename:_0x261f2b,url:_0x1e2115,dir:_0x2955a7}){const _0x5f4628=_0x207837,_0x382475=_0x513374,_0x2232e0=_0x31f519,{region:_0x4cdf59,bucket:_0x21da91,accessKeyId:_0x5dbe05,accessKeySecret:_0x17ace5}=await this[_0x2232e0(0x12d)](_0x2232e0(0x107)),_0x2a48e8=new ALIOSS({'region':_0x4cdf59,'accessKeyId':_0x5dbe05,'accessKeySecret':_0x17ace5,'bucket':_0x21da91});try{const _0x5ed057=await this[_0x2232e0(0x12b)][_0x2232e0(0x11f)]([_0x2232e0(0x10f)])||0x0;if(Number(_0x5ed057)===0x1){const _0x3c8d84={'url':_0x1e2115,'cosParams':{'region':_0x4cdf59,'bucket':_0x21da91,'accessKeyId':_0x5dbe05,'accessKeySecret':_0x17ace5},'cosType':_0x2232e0(0xd3)},_0x34d808=await this[_0x2232e0(0x12b)][_0x382475(0x133)]([_0x382475(0x146)])||_0x2232e0(0xd6),_0x47ddc9=await axios_1[_0x2232e0(0xf8)][_0x382475(0x10b)](_0x34d808+_0x2232e0(0x109),_0x3c8d84);if(!(_0x47ddc9===null||_0x47ddc9===void 0x0?void 0x0:_0x47ddc9[_0x2232e0(0x103)]))throw new common_1[(_0x2232e0(0xd4))](_0x2232e0(0xbf),common_1[_0x2232e0(0x12e)][_0x2232e0(0x120)]);return _0x47ddc9[_0x2232e0(0x103)];}else{const _0x419528=await this[_0x382475(0x157)](_0x1e2115);return await this[_0x5f4628(0x1f4)]({'filename':_0x261f2b,'buffer':_0x419528,'dir':_0x2955a7});}}catch(_0x6991a3){throw new common_1[(_0x2232e0(0xd4))](_0x2232e0(0xbf),common_1[_0x2232e0(0x12e)][_0x2232e0(0x120)]);}}async[_0x513374(0x15c)]({filename:filename='',buffer:_0x2912c1,dir:dir='ai',fileTyle:fileTyle=_0x31f519(0xd8)}){const _0x25aaa6=_0x207837,_0x420d37=_0x513374,_0x3ad021=_0x31f519;var _0x4a03a7;const {key:_0x5ea61d,uploadPath:_0x236976}=await this[_0x420d37(0x13a)](_0x3ad021(0xcb));let _0x404868=_0x236976[_0x3ad021(0xfb)]('/')?_0x236976[_0x3ad021(0x108)](0x0,-0x1):_0x236976;const _0x82620b=new FormData();_0x82620b[_0x420d37(0x121)](_0x420d37(0x12c),_0x2912c1),_0x82620b[_0x3ad021(0x118)](_0x420d37(0x15d),_0x5ea61d);try{const _0x285fe0=await axios_1[_0x3ad021(0xf8)][_0x3ad021(0xf4)](_0x404868,_0x82620b,{'headers':{'X-API-Key':_0x5ea61d}});if((_0x285fe0===null||_0x285fe0===void 0x0?void 0x0:_0x285fe0[_0x3ad021(0x12c)])===0xc8)return _0x285fe0[_0x3ad021(0x103)][_0x420d37(0x11c)][_0x420d37(0x163)];else console[_0x420d37(0x141)](_0x3ad021(0x10d),_0x285fe0===null||_0x285fe0===void 0x0?void 0x0:_0x285fe0[_0x420d37(0x172)][_0x3ad021(0xef)],_0x285fe0===null||_0x285fe0===void 0x0?void 0x0:_0x285fe0[_0x25aaa6(0x1d1)][_0x420d37(0x12f)][_0x420d37(0x10a)]),common_1[_0x3ad021(0x111)][_0x420d37(0x12f)](_0x3ad021(0xcf),JSON[_0x3ad021(0x10b)](_0x285fe0[_0x3ad021(0x103)]));}catch(_0xf3d12f){console['log'](_0x3ad021(0x114),_0xf3d12f);throw new common_1[(_0x3ad021(0xd4))](_0x3ad021(0x11a)+((_0x4a03a7=_0xf3d12f[_0x3ad021(0xec)])===null||_0x4a03a7===void 0x0?void 0x0:_0x4a03a7[_0x3ad021(0x103)][_0x420d37(0x12f)][_0x3ad021(0xc7)]),common_1[_0x3ad021(0x12e)][_0x3ad021(0x120)]);}}async[_0x31f519(0xe9)]({filename:_0x47202d,url:_0x1a75da,dir:_0x2be7a3}){const _0x387704=_0x207837,_0x1c0941=_0x513374,_0x491040=_0x31f519;try{const _0xf3a3a2=await this[_0x491040(0x12b)][_0x491040(0x11f)]([_0x491040(0x10f)])||0x0;if(Number(_0xf3a3a2)===0x1){const {key:_0x558d3f,uploadPath:_0x17a51a}=await this[_0x491040(0x12d)](_0x491040(0xcb));let _0x1f0fe8=_0x17a51a[_0x491040(0xfb)]('/')?_0x17a51a[_0x491040(0x108)](0x0,-0x1):_0x17a51a;const _0x3b62e6={'cosType':_0x491040(0xcb),'url':_0x1a75da,'cosParams':{'key':_0x558d3f,'uploadPath':_0x1f0fe8}},_0x45b419=await this[_0x491040(0x12b)][_0x491040(0x11f)]([_0x491040(0xf1)])||_0x491040(0xd6),_0x1c4f5d=await axios_1[_0x387704(0x1c8)][_0x491040(0xf4)](_0x45b419+_0x491040(0x109),_0x3b62e6);if(!_0x1c4f5d[_0x491040(0x103)])throw new common_1[(_0x491040(0xd4))](_0x491040(0xfd),common_1[_0x491040(0x12e)][_0x1c0941(0x123)]);return _0x1c4f5d[_0x491040(0x103)];}else{const _0x3e0844=await this[_0x387704(0x221)](_0x1a75da);return await this[_0x1c0941(0x15c)]({'filename':_0x47202d,'buffer':_0x3e0844,'dir':_0x2be7a3});}}catch(_0x6286dc){console[_0x491040(0xf3)](_0x491040(0x114),_0x6286dc);throw new common_1[(_0x491040(0xd4))](_0x6286dc[_0x491040(0xec)],common_1[_0x491040(0x12e)][_0x491040(0x120)]);}}async[_0x31f519(0x12d)](_0x2e727e){const _0x3047ca=_0x513374,_0x599fa0=_0x31f519;if(_0x2e727e==='ali'){const {aliOssRegion:_0x46df63,aliOssBucket:_0x74be05,aliOssAccessKeyId:_0x390fab,aliOssAccessKeySecret:_0x194ee9}=await this[_0x3047ca(0x17b)][_0x599fa0(0x11f)]([_0x599fa0(0xc5),_0x599fa0(0xf9),_0x599fa0(0xfa),_0x599fa0(0xd7)]);return{'region':_0x46df63,'bucket':_0x74be05,'accessKeyId':_0x390fab,'accessKeySecret':_0x194ee9};}if(_0x2e727e===_0x599fa0(0xe4)){const {cosBucket:_0x19efd5,cosRegion:_0x14be61,cosSecretId:_0x555f82,cosSecretKey:_0x4ecd6c,tencentCosAcceleratedDomain:_0x3d6724}=await this[_0x3047ca(0x17b)][_0x599fa0(0x11f)]([_0x599fa0(0x101),_0x599fa0(0xc2),_0x599fa0(0x106),_0x599fa0(0xe6),_0x599fa0(0x104)]);return{'Bucket':_0x19efd5,'Region':_0x14be61,'SecretId':_0x555f82,'SecretKey':_0x4ecd6c,'acceleratedDomain':_0x3d6724};}if(_0x2e727e===_0x599fa0(0xcb)){const {cheveretoKey:_0x3abf0f,cheveretoUploadPath:_0x3116bc}=await this[_0x599fa0(0x12b)][_0x3047ca(0x133)]([_0x3047ca(0x124),_0x599fa0(0x125)]);return{'key':_0x3abf0f,'uploadPath':_0x3116bc};}}async[_0x513374(0x130)](){const _0x10b918=_0x31f519,_0x287d76={'filename':_0x10b918(0xdf),'dir':'mj','url':_0x10b918(0x122)},_0x5707b0=await this[_0x10b918(0xed)](_0x287d76);return console[_0x10b918(0xf3)](_0x10b918(0x11c),_0x5707b0),_0x5707b0;}async[_0x31f519(0x100)](_0x2cfe2f){const _0x4d0981=_0x31f519,_0x3c8dfa=await this[_0x4d0981(0x12b)][_0x4d0981(0x11f)]([_0x4d0981(0x10f)])||0x0,_0x5220c3=await axios_1[_0x4d0981(0xf8)][_0x4d0981(0xc0)](_0x2cfe2f,{'responseType':_0x4d0981(0xdc)});return new Promise((_0x55f177,_0x5578a0)=>{const _0x2d2c0e=_0x4d0981;streamToBuffer(_0x5220c3[_0x2d2c0e(0x103)],(_0x3ac0f8,_0x4c646a)=>{const _0x4c6be2=_0x2d2c0e;if(_0x3ac0f8)throw new common_1[(_0x4c6be2(0xd4))](_0x4c6be2(0xfc),common_1[_0x4c6be2(0x12e)][_0x4c6be2(0x120)]);else _0x55f177(_0x4c646a);});});}};function _0x37ae(){const _0x129f3e=['metadata','2846ZAzAbj','image','slice','chevereto','https://cdn.discordapp.com/attachments/1097409128491651135/1169910551275638855/snine_60b5c001b_A_young_girl_smiles_brightly_in_the_pure_blue_f_8a41fe5f-5101-4c1e-b948-a748a0583577.png?ex=65571f1b&is=6544aa1b&hm=b82f2d88224eb7942e24c63a8e519c7693de12a2b96daa0f327dfb8f691b1480&','cos-nodejs-sdk-v5','115898XmxmbL','使用腾讯云COS上传','10OVxvzz','cosRegion','上传图片失败[ali]','length','debug','上传图片失败[ten][url]','aliyun','1251876RtFqVD','531706ZyHLOd','2665563OZDsTM','source','log','7483903bTwmDp','error','2883uSIMKk','uploadFileByAliOss','4484768jcMBhC','createRandomUid','env','mjtest.png','then','uploadFileFromUrl','get','../globalConfig/globalConfig.service','4060809SlCQfu','res:\x20','split','上传图片失败[Chevereto][url]','25664540rYEinj','716226KpvSOO','aliOssAccessKeySecret','cheveretoStatus','form-data','aliOssRegion','axios','replace','catch','object','84XQXBpi','tencentCos','cosSecretKey','375409wFAzEL','HttpStatus','ali\x20开始上传','push','mjProxyUrl','error:\x20','上传失败:\x20','ali','response','base64','TODO->error:\x20\x20','50KoLVYE','test','append','stream-to-buffer','6nzDKVB',',\x20阿里云:\x20','BAD_REQUEST','uploadFileByTencentCos','getBufferFromUrl','1pNsdtx','/mj/replaceUpload','8JLCrPg','tencent','上传图片失败[ten]',',\x20类型:\x20','stream','uploadFile','https://','上传配置状态\x20-\x20腾讯云:\x20','../../common/utils','cheveretoKey','3384570cNqyNd','3481080DQCqop','shift','aliOssAccessKeyId','getOwnPropertyDescriptor','https://$2','cheveretoUploadPath','globalConfigService','key','function','decorate','上传图片失败[Chevereto|buffer]\x20-->\x20','__metadata','HttpException','put','获取图片资源失败、请重新试试吧！','2268585gXxZQR','2429696WfsCGc','uploadFileByCheveretoFromUrl','uploadFileByAliOssFromUrl','status','493690DQXkuR','mjProxy','getUploadConfig','ISDEV','post','请先前往后台配置上传图片的方式',',\x20Chevereto:\x20','code','__esModule','design:paramtypes','toString','655WAHena','getUploadType','default','tencentCosStatus','url','准备上传文件:\x20','endsWith','526126bsammi','getConfigs','removeSpecialCharacters','mjdev','data','ali-oss','364357LRaYee','358836CPvRHu','onModuleInit','aliOssStatus','上传图片失败[Chevereto]','tencentCosAcceleratedDomain','使用Chevereto上传','cosBucket','12956NpOmnG'];_0x37ae=function(){return _0x129f3e;};return _0x37ae();}UploadService=__decorate([(0x0,common_1['Injectable'])(),__metadata(_0x31f519(0xe2),[globalConfig_service_1[_0x31f519(0xbc)]])],UploadService),exports['UploadService']=UploadService;