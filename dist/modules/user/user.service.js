'use strict';const _0x215313=_0xf71f;(function(_0x447554,_0x31bff2){const _0x550aef=_0xf71f,_0x49e4fe=_0x447554();while(!![]){try{const _0x32efe0=parseInt(_0x550aef(0x1cb))/0x1+parseInt(_0x550aef(0x1fd))/0x2*(-parseInt(_0x550aef(0x1b6))/0x3)+-parseInt(_0x550aef(0x19c))/0x4*(-parseInt(_0x550aef(0x1bb))/0x5)+parseInt(_0x550aef(0x1a3))/0x6*(-parseInt(_0x550aef(0x204))/0x7)+parseInt(_0x550aef(0x192))/0x8+-parseInt(_0x550aef(0x1e2))/0x9+parseInt(_0x550aef(0x154))/0xa;if(_0x32efe0===_0x31bff2)break;else _0x49e4fe['push'](_0x49e4fe['shift']());}catch(_0x520c59){_0x49e4fe['push'](_0x49e4fe['shift']());}}}(_0x3a1b,0xe1de1));function _0xf71f(_0x4ae5e1,_0x37bfb0){const _0x3a1bbe=_0x3a1b();return _0xf71f=function(_0xf71f52,_0x26544f){_0xf71f52=_0xf71f52-0x153;let _0x1e7e20=_0x3a1bbe[_0xf71f52];return _0x1e7e20;},_0xf71f(_0x4ae5e1,_0x37bfb0);}function _0x199e(_0x2598aa,_0x370836){const _0xdfa107=_0x54d3();return _0x199e=function(_0x34eaa3,_0x56d9e1){_0x34eaa3=_0x34eaa3-0xf5;let _0x5524ef=_0xdfa107[_0x34eaa3];return _0x5524ef;},_0x199e(_0x2598aa,_0x370836);}const _0x16c15e=_0x199e;function _0x3a1b(){const _0x431ab4=['registerIp','当前用户不存在！','$2y$','getUserOpenId','queryOneUserInfo','sendMail','Repository','metadata','registerBaseUrl','InjectRepository','avatar','BLACKLISTED','该微信已绑定其他账号！','status','../globalConfig/globalConfig.service','__metadata','inviteLink','configKey','VerificationService','__esModule','registerVerifyEmailFrom','./user.entity','digest','当前手机号已注册、请勿重复注册！','balanceInfo','107192XomNsp','log','2663586PQPCtS','user','../../common/constants/verification.constant','VerificationEnum','queryUserBalance','11221DFbyqe','verifyUserPassword','function','getSuper','createHash','$2a$','inviteCode','用户名已存在！','client','28496780ceucTY','恭喜您绑定成功、后续可直接扫码登录了！','userId','修改密码失败、请重新试试吧。','BAD_REQUEST','lastLoginIp','MailerService','PENDING','1813032pLbvOe','../../common/utils','不可将用户置为未激活状态！','registerVerifyEmailTitle','bcryptjs','object','isBindWx','修改用户信息成功！','getUserInfo','密码重置为[','addBalanceToUser','851dNDBrR','未激活用户不可手动变更状态！','----,','queryOne','configEntity','createVerification','UserBalanceService','HttpStatus','openId','UserEntity','phone','compareSync','../userBalance/userBalance.service','修改用户状态成功！','lodash','globalConfigService','ConfigEntity','RechargeType','password','获取邀请记录失败！','addBalanceToNewUser','UserStatusErrMsg','error:\x20','push','DESC','save','shift','getUserFromOpenId','LOCKED','8FlaWYO','saveRecordRechargeLog','forEach','map','findAndCount','getUserStatus','genInviteCode','230804zcrzHn','超级管理员不可被操作！','createUserAndVerifycation','UNAUTHORIZED','email\x20response\x20\x20->\x20:\x20','sign','2975280jgqJCY','3998704XcMXYo','用户不存在！','verifyUserCredentials','您的账户已被封禁、如有疑问、请联系管理员！','updateUserStatus','resetUserPass','isVerifyEmail','savaLoginIp','length','../../common/constants/balance.constant','20WuJSTi','userDefautlAvatar','configMap:\x20','register','当前账户不存在！','visitor','316191JTNDdv','4008CCZOII','WhiteListEntity','修改用户信息失败！','find','createdAt','1150020deJuXK','verifyUserRegisterByPhone','userRecharge','960226yYaQuu','getInviteRecord','role','qureyUserInfoByInviteCode','defineProperty','Registration','queryUserBalanceByIds','../../common/constants/user.constant','getOpenIdByUserId','生成邀请码失败，请重新试一次吧！','crypto','84KhkhXP','__param','split','1412872DRoYNC','maskEmail','1500055nqXVUm','UserStatusEnum','createUserFromOpenId','userEntity','cloneDeep','userBalanceService','createUser','的账号激活','重置密码失败！','getOwnPropertyDescriptor','Injectable','queryUserInfoById','getClientIp','updateInfo','design:paramtypes','decorate','422569zsCMgA','username','16038408exDZJA','../chatgpt/whiteList.entity','Not','当前用户信息失效、请重新登录！','getConfigs','@nestjs-modules/mailer','hex','md5','super','4028934mxeFaE','当前密码错误！','绑定微信失败、请联系管理员！','HttpException','generateRandomString','updateStatus','UserService','Like','3191432eBNhue','您的账户已被永久加入黑名单、如有疑问、请联系管理员！','maskIpAddress','mailerService','15979455LDjVLV','queryAll'];_0x3a1b=function(){return _0x431ab4;};return _0x3a1b();}(function(_0x15f7d1,_0x24ed64){const _0x35ccc3=_0xf71f,_0x250e60=_0x199e,_0x533413=_0x15f7d1();while(!![]){try{const _0x500495=-parseInt(_0x250e60(0x10d))/0x1*(parseInt(_0x250e60(0x197))/0x2)+-parseInt(_0x250e60(0x146))/0x3+parseInt(_0x250e60(0x150))/0x4+-parseInt(_0x250e60(0x172))/0x5+-parseInt(_0x250e60(0x185))/0x6+-parseInt(_0x250e60(0x155))/0x7+parseInt(_0x250e60(0x193))/0x8;if(_0x500495===_0x24ed64)break;else _0x533413[_0x35ccc3(0x17e)](_0x533413[_0x35ccc3(0x181)]());}catch(_0x355b43){_0x533413['push'](_0x533413[_0x35ccc3(0x181)]());}}}(_0x54d3,0x69a10));function _0x54d3(){const _0x13b4b3=_0xf71f,_0x50884d=[_0x13b4b3(0x17c),_0x13b4b3(0x19f),_0x13b4b3(0x1cd),_0x13b4b3(0x17f),_0x13b4b3(0x196),'assign','46tqbxkj',_0x13b4b3(0x1a5),'shift',_0x13b4b3(0x19b),_0x13b4b3(0x1d9),']成功!',_0x13b4b3(0x180),'用户名或者邮箱已被注册！',_0x13b4b3(0x15b),_0x13b4b3(0x1e6),'digest',_0x13b4b3(0x190),'startsWith',_0x13b4b3(0x1b1),_0x13b4b3(0x17b),'123456',_0x13b4b3(0x1bc),_0x13b4b3(0x157),_0x13b4b3(0x156),'GlobalConfigService',_0x13b4b3(0x1de),_0x13b4b3(0x171),'12OfxwlM',_0x13b4b3(0x173),_0x13b4b3(0x168),_0x13b4b3(0x1a0),_0x13b4b3(0x18d),_0x13b4b3(0x1b7),_0x13b4b3(0x17d),_0x13b4b3(0x1ed),_0x13b4b3(0x18c),_0x13b4b3(0x165),'@nestjs/typeorm',_0x13b4b3(0x1da),_0x13b4b3(0x1ab),_0x13b4b3(0x16f),_0x13b4b3(0x1ee),_0x13b4b3(0x1c8),_0x13b4b3(0x1f9),_0x13b4b3(0x1b2),_0x13b4b3(0x167),_0x13b4b3(0x1f5),_0x13b4b3(0x1f6),_0x13b4b3(0x1f1),_0x13b4b3(0x200),_0x13b4b3(0x185),'@default.com',_0x13b4b3(0x1df),_0x13b4b3(0x159),'当前绑定用户不存在！','userEntity','已生成过邀请码、请勿重复生成',_0x13b4b3(0x183),_0x13b4b3(0x198),_0x13b4b3(0x1e1),_0x13b4b3(0x15a),_0x13b4b3(0x1ce),_0x13b4b3(0x176),_0x13b4b3(0x203),_0x13b4b3(0x163),'../verification/verification.service',_0x13b4b3(0x1cf),_0x13b4b3(0x16a),_0x13b4b3(0x177),_0x13b4b3(0x1b8),_0x13b4b3(0x1e7),_0x13b4b3(0x206),_0x13b4b3(0x1c2),_0x13b4b3(0x1af),_0x13b4b3(0x1e0),_0x13b4b3(0x16c),_0x13b4b3(0x1d0),_0x13b4b3(0x1fe),_0x13b4b3(0x172),'connection','19856EdQGXt',_0x13b4b3(0x1c6),_0x13b4b3(0x1f8),'reduce',_0x13b4b3(0x186),_0x13b4b3(0x1a4),_0x13b4b3(0x1aa),'username',_0x13b4b3(0x15f),_0x13b4b3(0x1e4),_0x13b4b3(0x182),_0x13b4b3(0x153),'__decorate',_0x13b4b3(0x174),_0x13b4b3(0x1ec),_0x13b4b3(0x1bd),'email',_0x13b4b3(0x1d3),_0x13b4b3(0x19a),'findOne',_0x13b4b3(0x169),_0x13b4b3(0x1ad),_0x13b4b3(0x15c),_0x13b4b3(0x202),_0x13b4b3(0x1d2),_0x13b4b3(0x1a6),_0x13b4b3(0x193),_0x13b4b3(0x189),_0x13b4b3(0x155),'configVal','checkUserStatus',_0x13b4b3(0x1d7),_0x13b4b3(0x1b9),_0x13b4b3(0x17e),'affected',_0x13b4b3(0x19d),_0x13b4b3(0x1ef),_0x13b4b3(0x1d6),_0x13b4b3(0x1fc),_0x13b4b3(0x18e),'139320xPWDFq',_0x13b4b3(0x17a),_0x13b4b3(0x16d),_0x13b4b3(0x184),_0x13b4b3(0x195),_0x13b4b3(0x18b),'$2b$',_0x13b4b3(0x1a2),'无效的邀请码！',_0x13b4b3(0x1c3),_0x13b4b3(0x1d4),'没有变更，无需更改！',_0x13b4b3(0x1d5),'ADMIN_GIFT','update',_0x13b4b3(0x160),'verificationService',_0x13b4b3(0x1f4),_0x13b4b3(0x18a),_0x13b4b3(0x208),_0x13b4b3(0x1d1),_0x13b4b3(0x179),_0x13b4b3(0x1c1),'createRandomUid',_0x13b4b3(0x20a),_0x13b4b3(0x187),_0x13b4b3(0x1a8),'registerVerifyEmailDesc',_0x13b4b3(0x16b),_0x13b4b3(0x1e8),_0x13b4b3(0x197),_0x13b4b3(0x1b5),_0x13b4b3(0x1c4),_0x13b4b3(0x15d),_0x13b4b3(0x16e),'updateUserPassword',_0x13b4b3(0x1bf),_0x13b4b3(0x205),_0x13b4b3(0x1e9),'BAD_REQUEST',_0x13b4b3(0x1eb),_0x13b4b3(0x1c0),_0x13b4b3(0x201),'Connection','registerVerifyExpir',_0x13b4b3(0x191),_0x13b4b3(0x188),'@nestjs/common','用户名已存在、请更换用户名！',_0x13b4b3(0x1c7),_0x13b4b3(0x1e3),_0x13b4b3(0x170),_0x13b4b3(0x1a7),_0x13b4b3(0x1ff),'../globalConfig/config.entity',_0x13b4b3(0x1ba),_0x13b4b3(0x161)];return _0x54d3=function(){return _0x50884d;},_0x54d3();}const _0x3fcc6f=_0x2bea;(function(_0x1f8b5b,_0x330d05){const _0x544557=_0xf71f,_0x276823=_0x199e,_0x2d5f88=_0x2bea,_0x40921f=_0x1f8b5b();while(!![]){try{const _0x18fb10=parseInt(_0x2d5f88(0xcd))/0x1+-parseInt(_0x2d5f88(0xb2))/0x2*(-parseInt(_0x2d5f88(0xcc))/0x3)+-parseInt(_0x2d5f88(0x127))/0x4+parseInt(_0x2d5f88(0x75))/0x5*(-parseInt(_0x2d5f88(0x11d))/0x6)+-parseInt(_0x2d5f88(0xd4))/0x7+-parseInt(_0x2d5f88(0xe0))/0x8+-parseInt(_0x2d5f88(0xa6))/0x9;if(_0x18fb10===_0x330d05)break;else _0x40921f[_0x544557(0x17e)](_0x40921f[_0x276823(0x199)]());}catch(_0x24c72a){_0x40921f[_0x276823(0x151)](_0x40921f[_0x276823(0x199)]());}}}(_0x38cf,0x90d73));var __decorate=this&&this[_0x3fcc6f(0x7f)]||function(_0xc91243,_0x56cb36,_0x269c13,_0x14a74f){const _0x59462f=_0x199e,_0x1ed8b1=_0x3fcc6f;var _0x3d080e=arguments[_0x1ed8b1(0xc2)],_0xe252d7=_0x3d080e<0x3?_0x56cb36:_0x14a74f===null?_0x14a74f=Object[_0x59462f(0x178)](_0x56cb36,_0x269c13):_0x14a74f,_0x5c7efc;if(typeof Reflect===_0x1ed8b1(0xf7)&&typeof Reflect[_0x1ed8b1(0xa2)]===_0x1ed8b1(0xf5))_0xe252d7=Reflect[_0x1ed8b1(0xa2)](_0xc91243,_0x56cb36,_0x269c13,_0x14a74f);else{for(var _0xcb9c38=_0xc91243[_0x1ed8b1(0xc2)]-0x1;_0xcb9c38>=0x0;_0xcb9c38--)if(_0x5c7efc=_0xc91243[_0xcb9c38])_0xe252d7=(_0x3d080e<0x3?_0x5c7efc(_0xe252d7):_0x3d080e>0x3?_0x5c7efc(_0x56cb36,_0x269c13,_0xe252d7):_0x5c7efc(_0x56cb36,_0x269c13))||_0xe252d7;}return _0x3d080e>0x3&&_0xe252d7&&Object[_0x59462f(0x129)](_0x56cb36,_0x269c13,_0xe252d7),_0xe252d7;},__metadata=this&&this[_0x3fcc6f(0x111)]||function(_0x40711a,_0x4f3ea1){const _0x5662d7=_0x3fcc6f;if(typeof Reflect===_0x5662d7(0xf7)&&typeof Reflect[_0x5662d7(0xbf)]===_0x5662d7(0xf5))return Reflect[_0x5662d7(0xbf)](_0x40711a,_0x4f3ea1);},__param=this&&this[_0x16c15e(0x100)]||function(_0x2e1087,_0x5e30b1){return function(_0x1d44f5,_0x38e721){_0x5e30b1(_0x1d44f5,_0x38e721,_0x2e1087);};};Object[_0x3fcc6f(0xd2)](exports,_0x3fcc6f(0xed),{'value':!![]}),exports[_0x3fcc6f(0xad)]=void 0x0;function _0x2bea(_0xdfa6,_0x5994a5){const _0x1d5c37=_0x38cf();return _0x2bea=function(_0x3d7f4b,_0x1a6826){_0x3d7f4b=_0x3d7f4b-0x74;let _0x258677=_0x1d5c37[_0x3d7f4b];return _0x258677;},_0x2bea(_0xdfa6,_0x5994a5);}const globalConfig_service_1=require(_0x3fcc6f(0x9a)),user_constant_1=require(_0x3fcc6f(0x74)),mailer_1=require(_0x3fcc6f(0x92)),verification_service_1=require(_0x3fcc6f(0xc1)),common_1=require(_0x3fcc6f(0x121)),typeorm_1=require(_0x16c15e(0x105)),typeorm_2=require(_0x3fcc6f(0xc6)),user_entity_1=require(_0x3fcc6f(0xfb)),bcrypt=require(_0x3fcc6f(0x76)),crypto=require(_0x3fcc6f(0x7a)),_=require(_0x3fcc6f(0xa0)),verification_constant_1=require(_0x3fcc6f(0x8f)),userBalance_service_1=require(_0x16c15e(0xfc)),utils_1=require(_0x3fcc6f(0x7b)),balance_constant_1=require(_0x16c15e(0x19a)),config_entity_1=require(_0x3fcc6f(0xb8)),whiteList_entity_1=require(_0x3fcc6f(0x100));function _0x38cf(){const _0x1cb6b3=_0xf71f,_0x56a5de=_0x16c15e,_0x464455=[_0x56a5de(0x13e),_0x56a5de(0x16b),_0x56a5de(0x191),_0x56a5de(0x19c),_0x56a5de(0x140),_0x56a5de(0x163),_0x56a5de(0x184),_0x56a5de(0x195),_0x56a5de(0x182),_0x1cb6b3(0x176),_0x56a5de(0x164),_0x56a5de(0x148),_0x56a5de(0x18f),_0x56a5de(0x14a),_0x1cb6b3(0x1ac),_0x56a5de(0x124),_0x56a5de(0x16f),_0x1cb6b3(0x209),_0x56a5de(0x16c),_0x1cb6b3(0x1f2),_0x56a5de(0x11b),_0x56a5de(0x160),_0x56a5de(0x139),'ACTIVE',_0x56a5de(0x175),_0x1cb6b3(0x175),_0x56a5de(0x141),_0x1cb6b3(0x1ca),_0x56a5de(0x165),'consecutiveDays','UserStatusEnum',_0x56a5de(0x18d),_0x1cb6b3(0x186),_0x1cb6b3(0x166),_0x56a5de(0x128),_0x1cb6b3(0x1b3),_0x1cb6b3(0x1db),_0x56a5de(0x176),_0x1cb6b3(0x1dc),_0x56a5de(0x14b),_0x56a5de(0x113),_0x56a5de(0x118),'当前账户不存在！',_0x56a5de(0x15b),'hashSync',_0x56a5de(0x194),_0x1cb6b3(0x1d4),_0x56a5de(0x1a4),_0x1cb6b3(0x18f),_0x56a5de(0x18e),_0x56a5de(0x14f),_0x1cb6b3(0x207),_0x56a5de(0xff),_0x56a5de(0x152),_0x56a5de(0x112),_0x1cb6b3(0x19e),_0x56a5de(0x180),_0x1cb6b3(0x1d8),_0x56a5de(0x121),_0x56a5de(0x142),_0x1cb6b3(0x194),_0x1cb6b3(0x1a1),_0x56a5de(0x18b),'typeorm',_0x56a5de(0x14d),_0x56a5de(0x173),_0x56a5de(0x17a),'修改用户状态失败！',_0x56a5de(0x181),_0x56a5de(0x15f),_0x56a5de(0x107),_0x56a5de(0x186),_0x56a5de(0x168),_0x56a5de(0x10f),_0x56a5de(0x19d),_0x1cb6b3(0x1af),_0x56a5de(0x183),_0x56a5de(0x15d),_0x56a5de(0x159),_0x56a5de(0x11f),_0x1cb6b3(0x1b0),_0x56a5de(0x157),_0x56a5de(0x156),_0x56a5de(0x169),_0x56a5de(0x196),_0x56a5de(0x1a3),_0x56a5de(0x189),_0x56a5de(0x19e),_0x56a5de(0x1a2),_0x56a5de(0xf9),_0x56a5de(0x13a),_0x56a5de(0x104),'username',_0x56a5de(0x154),'whiteListEntity',_0x56a5de(0x19f),_0x56a5de(0x101),_0x56a5de(0x138),_0x56a5de(0x106),_0x56a5de(0x126),_0x56a5de(0x149),_0x56a5de(0x17b),_0x1cb6b3(0x1f7),_0x56a5de(0x110),_0x1cb6b3(0x1ee),_0x56a5de(0x147),_0x56a5de(0x102),_0x56a5de(0x16e),_0x56a5de(0x171),_0x1cb6b3(0x1ea),_0x56a5de(0x127),_0x56a5de(0x174),_0x56a5de(0x190),_0x56a5de(0x125),_0x56a5de(0x192),'findOne',_0x56a5de(0x10b),_0x1cb6b3(0x1b4),_0x1cb6b3(0x1d9),_0x56a5de(0x116),_0x56a5de(0x103),_0x56a5de(0x11d),_0x1cb6b3(0x1c9),_0x1cb6b3(0x1fb),'formatCreateOrUpdateDate',_0x56a5de(0x13d),_0x56a5de(0x170),_0x1cb6b3(0x1e5),_0x56a5de(0xf7),_0x56a5de(0x114),_0x56a5de(0x11c),_0x56a5de(0xfa),_0x1cb6b3(0x1f0),_0x56a5de(0x117),_0x56a5de(0xf8),_0x1cb6b3(0x16f),_0x56a5de(0x13b),'password',_0x1cb6b3(0x1f3),_0x56a5de(0x166),_0x56a5de(0x12b),_0x56a5de(0x1a5),_0x56a5de(0x12f),_0x56a5de(0x17d),_0x56a5de(0x115),'getUserById',_0x56a5de(0x145),_0x56a5de(0x10e),'maskIpAddress',_0x1cb6b3(0x158),_0x56a5de(0xfb),_0x1cb6b3(0x1c5),_0x56a5de(0x111),_0x56a5de(0x153),_0x56a5de(0x187),_0x56a5de(0x11a),_0x56a5de(0x136),_0x56a5de(0x18c),_0x56a5de(0x15e),_0x56a5de(0x123),_0x56a5de(0x130),_0x56a5de(0x18a),_0x56a5de(0x12e),_0x56a5de(0x12d),_0x56a5de(0x10c),_0x56a5de(0x158),_0x56a5de(0x167),_0x56a5de(0x13f),_0x1cb6b3(0x1e6),_0x1cb6b3(0x1dd),_0x56a5de(0x177),_0x56a5de(0x179),_0x56a5de(0x120),_0x1cb6b3(0x1fa),_0x56a5de(0x15c),_0x56a5de(0x13c),_0x56a5de(0x131),_0x56a5de(0x144),_0x56a5de(0x12c),'qureyUserInfoByInviteCode',_0x56a5de(0xfd),_0x1cb6b3(0x162),_0x1cb6b3(0x20b)];return _0x38cf=function(){return _0x464455;},_0x38cf();}let UserService=class UserService{constructor(_0x39f0d5,_0x3e916b,_0xb50592,_0x5f17e0,_0x52bc9b,_0x803b32,_0x550b11,_0x26a48a){const _0x2079af=_0x3fcc6f;this[_0x2079af(0x10c)]=_0x39f0d5,this[_0x2079af(0xe5)]=_0x3e916b,this[_0x2079af(0x115)]=_0xb50592,this[_0x2079af(0xcf)]=_0x5f17e0,this[_0x2079af(0x9b)]=_0x52bc9b,this[_0x2079af(0xcb)]=_0x803b32,this[_0x2079af(0x90)]=_0x550b11,this[_0x2079af(0xf6)]=_0x26a48a;}async[_0x3fcc6f(0xbb)](_0x7835e9,_0x1af9da){const _0x1c5f60=_0xf71f,_0x297be6=_0x16c15e,_0x345772=_0x3fcc6f,{username:_0x37ada9,email:_0x170d2e,password:_0x4ca52d,invitedBy:_0x1d54ae,client:client=0x0}=_0x7835e9;if(_0x1d54ae){const _0x26e496=await this[_0x297be6(0x117)][_0x345772(0xfa)]({'where':{'inviteCode':_0x1d54ae}});if(!_0x26e496)throw new common_1[(_0x345772(0xfd))](_0x345772(0x9c),common_1[_0x345772(0xc9)][_0x345772(0x11c)]);}const _0x638bfc=[{'username':_0x37ada9},{'email':_0x170d2e}],_0x325610=await this[_0x345772(0x10c)][_0x345772(0xfa)]({'where':_0x638bfc});if(_0x325610&&_0x325610[_0x345772(0xee)]!==user_constant_1[_0x345772(0xa5)][_0x345772(0xe6)])throw new common_1[(_0x297be6(0x19b))](_0x345772(0xde),common_1[_0x345772(0xc9)][_0x345772(0x11c)]);try{const _0x4a4575=_[_0x297be6(0x17c)](_0x7835e9),_0x101eed=bcrypt[_0x345772(0xb3)](_0x4ca52d,0xa),_0x451d20=(0x0,utils_1[_0x345772(0xdd)])(_0x1af9da);_0x4a4575[_0x345772(0x110)]=_0x101eed,_0x4a4575[_0x345772(0x9d)]=_0x451d20,_0x4a4575[_0x345772(0x10f)]=client;let _0x5a6f30;if(!_0x325610){const _0x65add6=await this[_0x297be6(0x11e)][_0x345772(0x99)]([_0x345772(0x120)]);_0x4a4575[_0x297be6(0x109)]=_0x65add6,_0x5a6f30=await this[_0x1c5f60(0x1be)][_0x345772(0xd1)](_0x4a4575);}else _0x5a6f30=_0x325610;const _0x31296e=await this[_0x297be6(0x174)][_0x345772(0xeb)]({'where':{'configKey':(0x0,typeorm_2['In'])([_0x297be6(0x11a),_0x345772(0x87),_0x345772(0xe8),_0x345772(0xc8),_0x297be6(0x132),_0x345772(0x8d)])}}),_0x3ba408=_0x31296e[_0x297be6(0x133)]((_0x44dd7e,_0x4fd010)=>{const _0x278a33=_0x345772;return _0x44dd7e[_0x4fd010[_0x278a33(0x11a)]]=_0x4fd010[_0x278a33(0xc7)],_0x44dd7e;},{}),_0xac8b92=_0x3ba408[_0x297be6(0x11a)]?Number(_0x3ba408[_0x345772(0x122)]):0x1;if(_0xac8b92){const _0x486190=_0x3ba408[_0x345772(0x8d)]?Number(_0x3ba408[_0x345772(0x8d)]):0x1e*0x3c,_0x477a52=await this[_0x345772(0xcf)][_0x345772(0x113)](_0x5a6f30,verification_constant_1[_0x345772(0xf0)][_0x345772(0xd7)],_0x486190),{code:_0x1a54ae,email:_0x1a2e5c,id:_0x285b1d}=_0x477a52,{registerVerifyEmailFrom:_0x3790bf}=_0x3ba408;console[_0x345772(0x12a)](_0x345772(0xbe),_0x3ba408);const _0x4616f5=await this['mailerService'][_0x297be6(0x17e)]({'to':_0x1a2e5c,'subject':'来自'+_0x3790bf+_0x345772(0xa9),'template':_0x345772(0xf9),'context':Object[_0x345772(0xdb)]({'baseUrl':_0x3ba408[_0x345772(0x87)],'code':_0x1a54ae,'id':_0x285b1d},_0x3ba408)});console[_0x345772(0x12a)](_0x345772(0xb7),_0x4616f5);}else{const {username:_0x3316c3,email:_0x13758f,id:_0x3c4c0c,invitedBy:_0x295fa9}=_0x5a6f30;await this[_0x345772(0x8e)](_0x3c4c0c,user_constant_1[_0x297be6(0xf5)][_0x345772(0x9e)]);let _0x1533e6;_0x295fa9&&(_0x1533e6=await this[_0x1c5f60(0x1ae)](_0x295fa9)),await this[_0x345772(0xcb)][_0x345772(0x114)](_0x3c4c0c,_0x1533e6===null||_0x1533e6===void 0x0?void 0x0:_0x1533e6['id']);}return _0x5a6f30;}catch(_0xcdbb00){console[_0x345772(0x12a)](_0x1c5f60(0x17d),_0xcdbb00);throw _0xcdbb00;}}async[_0x3fcc6f(0xba)](){const _0x3d5879=_0x16c15e,_0x353efb=_0x3fcc6f,_0x4ea05d=await this[_0x353efb(0x10c)][_0x353efb(0xfa)]({'where':{'role':_0x3d5879(0x164)}});return _0x4ea05d;}async[_0x3fcc6f(0xc3)](_0x198763){const _0x1e2e4a=_0xf71f,_0x4c954f=_0x16c15e,_0xaffd4c=_0x3fcc6f,{username:_0x46b79a,password:_0x2769c1,uid:uid=0x0,phone:_0x410db5}=_0x198763;let _0x227cdb=null;if(uid>0x0){_0x227cdb=await this[_0x4c954f(0x117)][_0xaffd4c(0xfa)]({'where':{'id':uid}});if(!_0x227cdb)throw new common_1[(_0x4c954f(0x19b))](_0xaffd4c(0xb1),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);if(_0x227cdb[_0xaffd4c(0x110)][_0xaffd4c(0xdc)](_0xaffd4c(0x98))||_0x227cdb[_0xaffd4c(0x110)][_0xaffd4c(0xdc)](_0xaffd4c(0x125))||_0x227cdb[_0xaffd4c(0x110)][_0xaffd4c(0xdc)](_0xaffd4c(0x78))){if(!bcrypt[_0x4c954f(0x12e)](_0x2769c1,_0x227cdb[_0xaffd4c(0x110)]))throw new common_1[(_0xaffd4c(0xfd))](_0xaffd4c(0xb9),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);}else{console[_0xaffd4c(0x12a)](_0xaffd4c(0x81));const _0x228985=crypto[_0xaffd4c(0x88)](_0xaffd4c(0xb5))[_0xaffd4c(0x112)](_0x2769c1)[_0xaffd4c(0x7d)](_0x1e2e4a(0x1d3));console[_0xaffd4c(0x12a)](_0xaffd4c(0x81),_0x228985);if(_0x228985!==_0x227cdb[_0xaffd4c(0x110)])throw new common_1[(_0xaffd4c(0xfd))](_0xaffd4c(0xb9),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);}}if(_0x46b79a&&_0x2769c1){const _0x5b3852=[{'username':_0x46b79a},{'email':_0x46b79a}];_0x227cdb=await this[_0x1e2e4a(0x1be)][_0xaffd4c(0xfa)]({'where':_0x5b3852});if(!_0x227cdb)throw new common_1[(_0xaffd4c(0xfd))](_0xaffd4c(0xb1),common_1[_0xaffd4c(0xc9)][_0x4c954f(0x17f)]);if(_0x227cdb[_0xaffd4c(0x110)][_0x4c954f(0x1a3)](_0xaffd4c(0x98))||_0x227cdb[_0x4c954f(0x16d)][_0xaffd4c(0xdc)](_0xaffd4c(0x125))||_0x227cdb[_0x4c954f(0x16d)][_0xaffd4c(0xdc)](_0x4c954f(0x1a0))){if(!bcrypt[_0xaffd4c(0x129)](_0x2769c1,_0x227cdb[_0xaffd4c(0x110)]))throw new common_1[(_0x1e2e4a(0x1d9))](_0xaffd4c(0xb9),common_1[_0x4c954f(0x17a)][_0xaffd4c(0x11c)]);}else{console[_0xaffd4c(0x12a)](_0xaffd4c(0x81));const _0x5585e6=crypto[_0x4c954f(0x16b)](_0xaffd4c(0xb5))[_0x4c954f(0x166)](_0x2769c1)[_0xaffd4c(0x7d)](_0xaffd4c(0xa1));console[_0x4c954f(0x12d)](_0xaffd4c(0x81),_0x5585e6);if(_0x5585e6!==_0x227cdb[_0x4c954f(0x16d)])throw new common_1[(_0x4c954f(0x19b))](_0xaffd4c(0xb9),common_1[_0xaffd4c(0xc9)][_0x4c954f(0x17f)]);}}if(_0x410db5&&_0x2769c1){const _0x2cc1c1=[{'phone':_0x410db5}];_0x227cdb=await this[_0x1e2e4a(0x1be)][_0xaffd4c(0xfa)]({'where':_0x2cc1c1});if(!_0x227cdb)throw new common_1[(_0xaffd4c(0xfd))](_0x4c954f(0xfe),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);if(_0x227cdb[_0xaffd4c(0x110)][_0xaffd4c(0xdc)](_0xaffd4c(0x98))||_0x227cdb[_0xaffd4c(0x110)][_0x4c954f(0x1a3)](_0xaffd4c(0x125))||_0x227cdb[_0xaffd4c(0x110)][_0xaffd4c(0xdc)](_0xaffd4c(0x78))){if(!bcrypt[_0x4c954f(0x12e)](_0x2769c1,_0x227cdb[_0xaffd4c(0x110)]))throw new common_1[(_0x4c954f(0x19b))](_0xaffd4c(0xb9),common_1[_0xaffd4c(0xc9)][_0x4c954f(0x17f)]);}else{console[_0x1e2e4a(0x1fe)](_0x4c954f(0x144));const _0xcd32bf=crypto[_0x4c954f(0x16b)](_0x4c954f(0x162))[_0xaffd4c(0x112)](_0x2769c1)[_0x4c954f(0x1a1)](_0x1e2e4a(0x1d3));console[_0xaffd4c(0x12a)](_0xaffd4c(0x81),_0xcd32bf);if(_0xcd32bf!==_0x227cdb[_0xaffd4c(0x110)])throw new common_1[(_0x4c954f(0x19b))](_0xaffd4c(0xb9),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);}}if(!_0x227cdb)throw new common_1[(_0xaffd4c(0xfd))](_0xaffd4c(0xb1),common_1[_0xaffd4c(0xc9)][_0xaffd4c(0x11c)]);if(_0x227cdb[_0xaffd4c(0xee)]!==user_constant_1[_0xaffd4c(0xa5)][_0xaffd4c(0x9e)])throw new common_1[(_0xaffd4c(0xfd))](user_constant_1[_0xaffd4c(0x89)][_0x227cdb[_0xaffd4c(0xee)]],common_1[_0x4c954f(0x17a)][_0xaffd4c(0x11c)]);return _0x227cdb;}async[_0x3fcc6f(0x116)](_0x5b5577,_0xa51f49){const _0x284a36=_0xf71f,_0x1fd2d3=_0x16c15e,_0x28f211=_0x3fcc6f,_0x5bdb5c=await this[_0x28f211(0x10c)][_0x1fd2d3(0x143)]({'where':{'id':_0x5b5577}});if(_0x5bdb5c[_0x28f211(0x110)][_0x28f211(0xdc)](_0x284a36(0x209))||_0x5bdb5c[_0x28f211(0x110)][_0x28f211(0xdc)](_0x28f211(0x125))||_0x5bdb5c[_0x28f211(0x110)][_0x28f211(0xdc)](_0x28f211(0x78)))return bcrypt[_0x28f211(0x129)](_0xa51f49,_0x5bdb5c[_0x284a36(0x179)]);else{const _0x17984a=crypto[_0x28f211(0x88)](_0x28f211(0xb5))[_0x1fd2d3(0x166)](_0xa51f49)[_0x284a36(0x1fa)](_0x28f211(0xa1));return console[_0x28f211(0x12a)](_0x28f211(0x81),_0x17984a),_0x17984a===_0x5bdb5c[_0x1fd2d3(0x16d)];}}async[_0x16c15e(0x195)](_0x44e7bd,_0x269813){const _0x22fca9=_0x16c15e,_0x43fdf8=_0x3fcc6f,_0x5c01f1=await this[_0x22fca9(0x117)][_0x43fdf8(0x112)]({'id':_0x44e7bd},{'status':_0x269813});return _0x5c01f1[_0x43fdf8(0xbc)]>0x0;}async[_0x3fcc6f(0xae)](_0x2d8eeb){const _0x548046=_0x16c15e,_0x461792=_0x3fcc6f,_0x3a01a0=await this[_0x461792(0x10c)][_0x461792(0xfa)]({'where':{'id':_0x2d8eeb}});return _0x3a01a0[_0x548046(0x110)];}async[_0x3fcc6f(0x80)](_0x3e0fea){const _0x6c7463=_0x3fcc6f;return await this[_0x6c7463(0x10c)][_0x6c7463(0xfa)]({'where':{'id':_0x3e0fea}});}async[_0x3fcc6f(0x9f)](_0x2c3c34){const _0x1f1bcb=_0x3fcc6f;return await this[_0x1f1bcb(0x10c)][_0x1f1bcb(0xfa)]({'where':{'id':_0x2c3c34}});}async[_0x16c15e(0x14e)](_0x40f11e){const _0x442cb6=_0x16c15e,_0x1c9874=_0x3fcc6f,{id:_0x3c196c,role:_0x34cb3d}=_0x40f11e;if(_0x34cb3d===_0x1c9874(0xc4))return!![];const _0x1d0fda=await this[_0x442cb6(0x117)][_0x1c9874(0xfa)]({'where':{'id':_0x3c196c}});if(!_0x1d0fda)throw new common_1[(_0x1c9874(0xfd))](_0x442cb6(0x12c),common_1[_0x1c9874(0xc9)][_0x1c9874(0xd8)]);if(_0x1d0fda[_0x1c9874(0xee)]===user_constant_1[_0x1c9874(0xa5)][_0x1c9874(0xe4)])throw new common_1[(_0x1c9874(0xfd))](_0x1c9874(0x108),common_1[_0x1c9874(0xc9)][_0x1c9874(0x11c)]);if(_0x1d0fda[_0x442cb6(0x110)]===user_constant_1[_0x1c9874(0xa5)][_0x442cb6(0x119)])throw new common_1[(_0x1c9874(0xfd))](_0x1c9874(0x7e),common_1[_0x1c9874(0xc9)][_0x1c9874(0x11c)]);}async[_0x215313(0x164)](_0x23cb1d){const _0x46978c=_0x215313,_0x166d40=_0x16c15e,_0x42adf1=_0x3fcc6f,_0x17992a=await this[_0x42adf1(0x10c)][_0x42adf1(0xfa)]({'where':{'id':_0x23cb1d},'select':[_0x42adf1(0xe3),_0x42adf1(0xef),_0x42adf1(0x119),_0x42adf1(0x8b),_0x42adf1(0xdf),_0x42adf1(0x105),_0x42adf1(0x10e),_0x42adf1(0xa4)]});if(!_0x17992a)throw new common_1[(_0x42adf1(0xfd))](_0x42adf1(0x82),common_1[_0x42adf1(0xc9)][_0x42adf1(0xd8)]);_0x17992a[_0x42adf1(0x85)]=!!(_0x17992a===null||_0x17992a===void 0x0?void 0x0:_0x17992a[_0x42adf1(0x10e)]),delete _0x17992a[_0x46978c(0x16f)];const _0x192c82=await this[_0x42adf1(0xcb)][_0x42adf1(0xd6)](_0x23cb1d);return{'userInfo':_0x17992a,'userBalance':Object[_0x166d40(0x196)]({},_0x192c82)};}async[_0x3fcc6f(0x118)](_0xfc8267){const _0x19dad9=_0x3fcc6f;return await this[_0x19dad9(0x10c)][_0x19dad9(0xfa)]({'where':{'id':_0xfc8267}});}async[_0x3fcc6f(0xea)](_0x3a101e){const _0x59ba9f=_0x3fcc6f;return await this[_0x59ba9f(0x10c)][_0x59ba9f(0xfa)]({'where':{'openId':_0x3a101e}});}async[_0x16c15e(0x10a)](_0x17efa8,_0x574020){const _0x52dc96=_0x215313,_0x4e2cc1=_0x16c15e,_0x248505=_0x3fcc6f,{id:_0x1d7bb5}=_0x574020[_0x248505(0x11f)],_0x5a8fa6=await this[_0x248505(0x10c)][_0x248505(0xfa)]({'where':{'id':_0x1d7bb5}});if(!_0x5a8fa6)throw new common_1[(_0x248505(0xfd))](_0x248505(0x106),common_1[_0x248505(0xc9)][_0x4e2cc1(0x17f)]);if(_0x17efa8[_0x248505(0xe3)]&&_0x5a8fa6[_0x248505(0xe3)]===_0x17efa8[_0x52dc96(0x1cc)])throw new common_1[(_0x248505(0xfd))](_0x248505(0x8c),common_1[_0x248505(0xc9)][_0x4e2cc1(0x17f)]);if(_0x17efa8[_0x248505(0xe3)]){const _0x5d7a39=await this[_0x52dc96(0x1be)][_0x248505(0xfa)]({'where':{'username':_0x17efa8[_0x4e2cc1(0x137)],'id':(0x0,typeorm_2[_0x4e2cc1(0x122)])(_0x1d7bb5)}});if(_0x5d7a39)throw new common_1[(_0x248505(0xfd))](_0x248505(0x86),common_1[_0x248505(0xc9)][_0x248505(0x11c)]);}const _0x4ffeed=await this[_0x248505(0x10c)][_0x4e2cc1(0x166)]({'id':_0x1d7bb5},_0x17efa8);if(_0x4ffeed[_0x248505(0xbc)]<=0x0)throw new common_1[(_0x248505(0xfd))](_0x4e2cc1(0x198),common_1[_0x52dc96(0x16e)][_0x4e2cc1(0x17f)]);return _0x248505(0x7c);}async[_0x3fcc6f(0xec)](_0x5b6aab,_0x163232){const _0x2e233e=_0x215313,_0x1a5ba7=_0x16c15e,_0x26d497=_0x3fcc6f,_0x2aa7ac=bcrypt[_0x26d497(0xb3)](_0x163232,0xa),_0x3e1ee9=await this[_0x26d497(0x10c)][_0x26d497(0x112)]({'id':_0x5b6aab},{'password':_0x2aa7ac});if(_0x3e1ee9[_0x26d497(0xbc)]<=0x0)throw new common_1[(_0x26d497(0xfd))](_0x1a5ba7(0xf6),common_1[_0x26d497(0xc9)][_0x2e233e(0x158)]);}async[_0x16c15e(0x16a)](_0x21a981){const _0x32b490=_0x215313,_0x1f93d6=_0x16c15e,_0x57ef53=_0x3fcc6f,{id:_0x3b8725}=_0x21a981[_0x57ef53(0x11f)],_0x2a26e9=await this[_0x57ef53(0x10c)][_0x57ef53(0xfa)]({'where':{'id':_0x3b8725}});if(!_0x2a26e9||_0x2a26e9[_0x57ef53(0x105)])throw new common_1[(_0x57ef53(0xfd))](_0x57ef53(0xb0),common_1[_0x32b490(0x16e)][_0x32b490(0x158)]);const _0x230dfc=(0x0,utils_1[_0x57ef53(0xe9)])(),_0x50c6cc=await this[_0x57ef53(0x10c)][_0x1f93d6(0x143)]({'where':{'inviteCode':_0x230dfc}});if(_0x50c6cc)throw new common_1[(_0x57ef53(0xfd))](_0x57ef53(0xfc),common_1[_0x57ef53(0xc9)][_0x1f93d6(0x17f)]);const _0x531d08=await this[_0x57ef53(0x10c)][_0x57ef53(0x112)]({'id':_0x3b8725},{'inviteCode':_0x230dfc});if(_0x531d08[_0x57ef53(0xbc)]<=0x0)throw new common_1[(_0x1f93d6(0x19b))](_0x57ef53(0xfc),common_1[_0x1f93d6(0x17a)][_0x57ef53(0x11c)]);return _0x230dfc;}async[_0x3fcc6f(0x95)](_0x20a162,_0x1383ea){const _0xecff1a=_0x16c15e,_0x465c0e=_0x3fcc6f;try{const {id:_0x58f93c}=_0x20a162[_0x465c0e(0x11f)],{page:page=0x1,size:size=0xa}=_0x1383ea,_0x47b230=await this[_0x465c0e(0x10c)][_0x465c0e(0xfa)]({'where':{'id':_0x58f93c}}),{inviteCode:_0x1a855d}=_0x47b230;if(!_0x1a855d)return[];const [_0x3eaa0a,_0x28b97f]=await this[_0x465c0e(0x10c)][_0x465c0e(0xce)]({'where':{'inviteCode':_0x1a855d},'order':{'id':_0x465c0e(0xb4)},'select':[_0x465c0e(0xe3),_0x465c0e(0x8b),_0x465c0e(0x124),_0xecff1a(0x110),_0xecff1a(0x109)],'take':size,'skip':(page-0x1)*size});return(0x0,utils_1[_0x465c0e(0x103)])(_0x3eaa0a)[_0xecff1a(0x171)](_0x41774d=>{const _0x2187f6=_0x465c0e;return _0x41774d[_0x2187f6(0x8b)]=(0x0,utils_1[_0x2187f6(0x93)])(_0x41774d[_0x2187f6(0x8b)]),_0x41774d;}),{'rows':_0x3eaa0a,'count':_0x28b97f};}catch(_0x422708){console[_0x465c0e(0x12a)](_0x465c0e(0xe7),_0x422708);throw new common_1[(_0x465c0e(0xfd))](_0x465c0e(0xd5),common_1[_0x465c0e(0xc9)][_0x465c0e(0x11c)]);}}async[_0x3fcc6f(0xda)](_0x252d24){const _0x24e37e=_0x16c15e,_0x517865=_0x3fcc6f,_0xc99ce=await this[_0x517865(0x10c)][_0x24e37e(0x143)]({'where':{'inviteCode':_0x252d24}});if(!_0xc99ce)return 0x1;const {inviteLinkCount:inviteLinkCount=0x0}=_0xc99ce,_0x431ab5=await this[_0x517865(0x10c)][_0x517865(0x112)]({'inviteCode':_0x252d24},{'inviteLinkCount':inviteLinkCount+0x1});return _0x431ab5[_0x24e37e(0x152)]?0x1:0x0;}async[_0x3fcc6f(0x83)](_0x220534){const _0x2494b4=_0x3fcc6f;return await this[_0x2494b4(0x10c)][_0x2494b4(0xfa)]({'where':{'inviteCode':_0x220534}});}async[_0x3fcc6f(0x123)](_0x11e4ef){const _0xd90b05=_0x215313,_0xf4f0a1=_0x3fcc6f,{userId:_0x3ea45a,model3Count:model3Count=0x0,model4Count:model4Count=0x0,drawMjCount:drawMjCount=0x0}=_0x11e4ef;await this[_0xf4f0a1(0xcb)][_0xf4f0a1(0xa8)](_0x3ea45a,{'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount});const _0x128168=await this[_0xf4f0a1(0xcb)][_0xf4f0a1(0xbd)]({'userId':_0x3ea45a,'rechargeType':balance_constant_1[_0xd90b05(0x178)][_0xf4f0a1(0xa3)],'model3Count':model3Count,'model4Count':model4Count,'drawMjCount':drawMjCount,'extent':''});return _0x128168;}async[_0x3fcc6f(0x128)](_0x340dd2,_0x1e68c2){const _0xbeea03=_0x215313,_0x4e2aff=_0x16c15e,_0x52c829=_0x3fcc6f,{page:page=0x1,size:size=0xa,username:_0x1ee5f8,email:_0x482521,status:_0x2ee226,keyword:_0x2d2afa,phone:_0xc8864}=_0x340dd2;let _0x4f35f3={};_0x1ee5f8&&Object[_0x4e2aff(0x196)](_0x4f35f3,{'username':(0x0,typeorm_2[_0x52c829(0x79)])('%'+_0x1ee5f8+'%')}),_0x482521&&Object[_0x52c829(0xdb)](_0x4f35f3,{'email':(0x0,typeorm_2[_0x52c829(0x79)])('%'+_0x482521+'%')}),_0xc8864&&Object[_0x4e2aff(0x196)](_0x4f35f3,{'phone':(0x0,typeorm_2[_0x52c829(0x79)])('%'+_0xc8864+'%')}),_0x2ee226&&Object[_0x52c829(0xdb)](_0x4f35f3,{'status':_0x2ee226}),_0x2d2afa&&(_0x4f35f3=[{'username':(0x0,typeorm_2[_0x52c829(0x79)])('%'+_0x2d2afa+'%')},{'email':(0x0,typeorm_2['Like'])('%'+_0x2d2afa+'%')},{'phone':(0x0,typeorm_2[_0x52c829(0x79)])('%'+_0x2d2afa+'%')}]);const [_0x37db22,_0x29ad85]=await this[_0x52c829(0x10c)][_0x52c829(0xce)]({'skip':(page-0x1)*size,'where':_0x4f35f3,'take':size,'order':{'createdAt':_0x52c829(0xb4)},'cache':!![],'select':[_0x52c829(0xe3),_0x52c829(0xef),_0x4e2aff(0x170),_0x52c829(0x119),_0x52c829(0xdf),_0x52c829(0xee),'id',_0x52c829(0x8b),_0x52c829(0x124),_0x52c829(0x117),_0x52c829(0x10a)]}),_0x2c6a27=_0x37db22[_0x52c829(0xf3)](_0x534499=>_0x534499['id']),_0x2b600b=await this[_0x52c829(0xcb)][_0x52c829(0xb6)](_0x2c6a27);return _0x37db22[_0x52c829(0xa7)](_0x1175d2=>_0x1175d2[_0x52c829(0xd9)]=_0x2b600b[_0x52c829(0xeb)](_0x284cfa=>_0x284cfa[_0x52c829(0x107)]===_0x1175d2['id'])),_0x1e68c2[_0x52c829(0x11f)][_0x52c829(0x119)]!==_0x52c829(0x91)&&_0x37db22[_0x4e2aff(0x134)](_0x387057=>_0x387057[_0x52c829(0x8b)]=(0x0,utils_1[_0x52c829(0x93)])(_0x387057[_0x52c829(0x8b)])),_0x1e68c2[_0xbeea03(0x200)][_0x52c829(0x119)]!==_0x52c829(0x91)&&_0x37db22[_0x4e2aff(0x134)](_0x3260b6=>_0x3260b6[_0x4e2aff(0x115)]=(0x0,utils_1[_0x52c829(0x11b)])(_0x3260b6[_0xbeea03(0x159)])),_0x1e68c2[_0x4e2aff(0x111)][_0x52c829(0x119)]!==_0x4e2aff(0x164)&&_0x37db22[_0x4e2aff(0x134)](_0x5a8829=>_0x5a8829[_0x52c829(0x10a)]=(0x0,utils_1[_0x4e2aff(0x12a)])(_0x5a8829[_0x52c829(0x10a)])),{'rows':_0x37db22,'count':_0x29ad85};}async[_0x3fcc6f(0x126)]({id:_0x5dbd6b}){const _0x498021=_0x16c15e,_0x33776c=_0x3fcc6f;return await this[_0x33776c(0x10c)][_0x33776c(0xfa)]({'where':{'id':_0x5dbd6b},'select':[_0x33776c(0xe3),_0x498021(0x109),_0x33776c(0x105),_0x498021(0x145),_0x33776c(0xdf),_0x33776c(0xee)]});}async[_0x3fcc6f(0xab)](_0x54a2cd){const _0x1bae65=_0x215313,_0x340433=_0x16c15e,_0x5e7de2=_0x3fcc6f,{id:_0x22ed6c,status:_0x510a8b}=_0x54a2cd,_0x4ce919=await this[_0x5e7de2(0x10c)][_0x340433(0x143)]({'where':{'id':_0x22ed6c}});if(!_0x4ce919)throw new common_1[(_0x340433(0x19b))](_0x5e7de2(0x94),common_1[_0x5e7de2(0xc9)][_0x1bae65(0x158)]);if(_0x4ce919[_0x5e7de2(0x119)]===_0x5e7de2(0x91))throw new common_1[(_0x5e7de2(0xfd))](_0x340433(0x103),common_1[_0x5e7de2(0xc9)][_0x5e7de2(0x11c)]);if(_0x4ce919[_0x1bae65(0x1f1)]===user_constant_1[_0x340433(0xf5)][_0x5e7de2(0xe6)])throw new common_1[(_0x5e7de2(0xfd))](_0x5e7de2(0x84),common_1[_0x5e7de2(0xc9)][_0x5e7de2(0x11c)]);if(_0x4ce919[_0x340433(0x145)]===_0x340433(0x164))throw new common_1[(_0x5e7de2(0xfd))](_0x5e7de2(0xff),common_1[_0x5e7de2(0xc9)][_0x5e7de2(0x11c)]);if(_0x510a8b===user_constant_1[_0x5e7de2(0xa5)][_0x5e7de2(0xe6)])throw new common_1[(_0x340433(0x19b))](_0x1bae65(0x15e),common_1[_0x5e7de2(0xc9)][_0x5e7de2(0x11c)]);const _0x119930=await this[_0x5e7de2(0x10c)][_0x5e7de2(0x112)]({'id':_0x22ed6c},{'status':_0x510a8b});if(_0x119930[_0x5e7de2(0xbc)]<=0x0)throw new common_1[(_0x5e7de2(0xfd))](_0x5e7de2(0xca),common_1[_0x5e7de2(0xc9)][_0x5e7de2(0x11c)]);return _0x5e7de2(0x104);}async[_0x3fcc6f(0xac)](_0x1f1853){const _0x387952=_0x16c15e,_0x5b5dda=_0x3fcc6f,{id:_0x3f763d}=_0x1f1853,_0x4e83d8=await this[_0x5b5dda(0x10c)][_0x387952(0x143)]({'where':{'id':_0x3f763d}});if(!_0x4e83d8)throw new common_1[(_0x5b5dda(0xfd))](_0x5b5dda(0x94),common_1[_0x387952(0x17a)][_0x5b5dda(0x11c)]);const _0xe9fd29=_0x387952(0x1a6),_0x310500=bcrypt[_0x5b5dda(0xb3)](_0xe9fd29,0xa),_0x1e3f10=await this[_0x5b5dda(0x10c)][_0x5b5dda(0x112)]({'id':_0x3f763d},{'password':_0x310500});if(_0x1e3f10[_0x5b5dda(0xbc)]<=0x0)throw new common_1[(_0x5b5dda(0xfd))](_0x387952(0x161),common_1[_0x5b5dda(0xc9)][_0x5b5dda(0x11c)]);return _0x5b5dda(0xe2)+_0xe9fd29+_0x5b5dda(0x8a);}async[_0x215313(0x199)](_0x2aeec2,_0x52623f){const _0x509361=_0x16c15e,_0x28778b=_0x3fcc6f;return await this[_0x28778b(0x10c)][_0x509361(0x166)]({'id':_0x2aeec2},{'lastLoginIp':_0x52623f});}async[_0x3fcc6f(0xe1)](_0x272c83,_0x1469b6){const _0x33d79d=_0x215313,_0x57051f=_0x16c15e,_0xba5747=_0x3fcc6f,_0x233b01=await this[_0xba5747(0x10c)][_0xba5747(0xfa)]({'where':{'openId':_0x272c83}});if(!_0x233b01){const _0x2bf691=_0x1469b6?_0x1469b6[_0xba5747(0xf8)](':')[0x1]:'',_0x1325bf=await this[_0xba5747(0x83)](_0x2bf691),_0x2402bb=await this[_0x57051f(0x13f)](_0x272c83,_0x2bf691);return await this[_0xba5747(0xcb)][_0x33d79d(0x17b)](_0x2402bb['id'],_0x2bf691?_0x1325bf===null||_0x1325bf===void 0x0?void 0x0:_0x1325bf['id']:null),_0x2402bb;}return _0x233b01;}async[_0x3fcc6f(0x77)](_0x59f805,_0x389d9a){const _0x4cb93d=_0x3fcc6f,_0x1298b9=await this[_0x4cb93d(0x90)][_0x4cb93d(0x99)]([_0x4cb93d(0x120)]),_0x241033={'avatar':_0x1298b9,'username':'用户'+(0x0,utils_1[_0x4cb93d(0x97)])(),'status':user_constant_1[_0x4cb93d(0xa5)][_0x4cb93d(0x9e)],'sex':0x0,'email':(0x0,utils_1[_0x4cb93d(0x97)])()+_0x4cb93d(0xaf),'invitedBy':_0x389d9a,'openId':_0x59f805},_0x3b7548=await this[_0x4cb93d(0x10c)][_0x4cb93d(0xd1)](_0x241033);return _0x3b7548;}async['bindWx'](_0x591c6c,_0x544cf5){const _0x1babec=_0x16c15e,_0x4e266b=_0x3fcc6f;try{const _0x1e6276=await this[_0x4e266b(0x10c)][_0x4e266b(0xfa)]({'where':{'id':_0x544cf5}});if(!_0x1e6276)return{'status':![],'msg':_0x4e266b(0xfe)};const _0xd5cc31=await this[_0x4e266b(0x10c)][_0x4e266b(0xfa)]({'where':{'openId':_0x591c6c}});if(_0xd5cc31)return{'status':![],'msg':_0x4e266b(0x10b)};const _0xfa202=await this[_0x4e266b(0x10c)][_0x4e266b(0x112)]({'id':_0x544cf5},{'openId':_0x591c6c});if(_0xfa202[_0x4e266b(0xbc)]<=0x0)return{'status':![],'msg':_0x4e266b(0xc0)};return{'status':!![],'msg':_0x1babec(0x14c)};}catch(_0x4e2896){return{'status':![],'msg':_0x4e266b(0xc0)};}}async[_0x3fcc6f(0xaa)](_0x364e73){const _0x39173c=_0x16c15e,_0x72e52c=_0x3fcc6f,_0x3f4b3f=await this[_0x72e52c(0x10c)][_0x72e52c(0xfa)]({'where':{'id':_0x364e73}});return _0x3f4b3f===null||_0x3f4b3f===void 0x0?void 0x0:_0x3f4b3f[_0x39173c(0x108)];}async[_0x215313(0x1a9)](_0x391f1d){const _0x2c6210=_0x16c15e,_0x4e59b8=_0x3fcc6f,{username:_0xf51d3c,password:_0x43cfa7,phone:_0x268db4,phoneCode:_0x22eb66}=_0x391f1d,_0x34904d=await this[_0x4e59b8(0x10c)][_0x4e59b8(0xfa)]({'where':[{'username':_0xf51d3c},{'phone':_0x268db4}]});if(_0x34904d&&_0x34904d[_0x4e59b8(0xe3)]===_0xf51d3c)throw new common_1[(_0x2c6210(0x19b))](_0x2c6210(0x188),common_1[_0x4e59b8(0xc9)][_0x4e59b8(0x11c)]);if(_0x34904d&&_0x34904d[_0x4e59b8(0x10a)]===_0x268db4)throw new common_1[(_0x4e59b8(0xfd))](_0x4e59b8(0x102),common_1[_0x2c6210(0x17a)][_0x2c6210(0x17f)]);}async[_0x3fcc6f(0xf2)](_0x457115){const _0x158c21=_0x3fcc6f;return await this[_0x158c21(0x10c)][_0x158c21(0xd1)](_0x457115);}};UserService=__decorate([(0x0,common_1[_0x3fcc6f(0x11e)])(),__param(0x0,(0x0,typeorm_1[_0x3fcc6f(0xf1)])(user_entity_1[_0x3fcc6f(0xc5)])),__param(0x1,(0x0,typeorm_1[_0x3fcc6f(0xf1)])(whiteList_entity_1[_0x16c15e(0x135)])),__param(0x7,(0x0,typeorm_1[_0x3fcc6f(0xf1)])(config_entity_1[_0x3fcc6f(0x96)])),__metadata(_0x3fcc6f(0x101),[typeorm_2[_0x3fcc6f(0xf4)],typeorm_2[_0x215313(0x1ea)],typeorm_2[_0x3fcc6f(0xd3)],verification_service_1[_0x3fcc6f(0xd0)],mailer_1[_0x3fcc6f(0x109)],userBalance_service_1[_0x16c15e(0x15a)],globalConfig_service_1[_0x3fcc6f(0x10d)],typeorm_2[_0x3fcc6f(0xf4)]])],UserService),exports[_0x3fcc6f(0xad)]=UserService;