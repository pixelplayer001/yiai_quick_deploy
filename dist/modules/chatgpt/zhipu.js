'use strict';const _0x17fa4f=_0x428f;(function(_0x775fd8,_0xdec595){const _0x270264=_0x428f,_0x3b5648=_0x775fd8();while(!![]){try{const _0xd269ba=-parseInt(_0x270264(0x147))/0x1*(parseInt(_0x270264(0x130))/0x2)+-parseInt(_0x270264(0x142))/0x3*(parseInt(_0x270264(0x155))/0x4)+parseInt(_0x270264(0x137))/0x5+-parseInt(_0x270264(0x150))/0x6+parseInt(_0x270264(0x13d))/0x7+-parseInt(_0x270264(0x153))/0x8+-parseInt(_0x270264(0x160))/0x9*(-parseInt(_0x270264(0x139))/0xa);if(_0xd269ba===_0xdec595)break;else _0x3b5648['push'](_0x3b5648['shift']());}catch(_0x4b38d3){_0x3b5648['push'](_0x3b5648['shift']());}}}(_0x2384,0xd486a));const _0x268e2e=_0x351d;function _0x351d(_0xd62d33,_0x1746b7){const _0x3ad38b=_0x247a();return _0x351d=function(_0x3c5640,_0x307dab){_0x3c5640=_0x3c5640-0x13a;let _0x3962fc=_0x3ad38b[_0x3c5640];return _0x3962fc;},_0x351d(_0xd62d33,_0x1746b7);}function _0x247a(){const _0x42e695=_0x428f,_0x214bf1=[_0x42e695(0x13c),_0x42e695(0x136),_0x42e695(0x13b),_0x42e695(0x138),_0x42e695(0x15e),_0x42e695(0x13a),_0x42e695(0x140),_0x42e695(0x15b),'https://open.bigmodel.cn/api/paas/v3/model-api/','SIGN','id:',_0x42e695(0x13f),_0x42e695(0x143),_0x42e695(0x135),'text',_0x42e695(0x132),_0x42e695(0x14d),_0x42e695(0x161),_0x42e695(0x141),_0x42e695(0x14e),_0x42e695(0x148),'sendMessageFromZhipu',_0x42e695(0x152),_0x42e695(0x159),_0x42e695(0x146),_0x42e695(0x144),_0x42e695(0x157),_0x42e695(0x14f),_0x42e695(0x145),_0x42e695(0x154),'filter',_0x42e695(0x15f),_0x42e695(0x14a),'586831JGesxL',_0x42e695(0x149),_0x42e695(0x156),_0x42e695(0x134),_0x42e695(0x151),_0x42e695(0x14b),_0x42e695(0x158),'810932stcyQB'];return _0x247a=function(){return _0x214bf1;},_0x247a();}(function(_0x4a265d,_0x89819a){const _0x2c43ef=_0x428f,_0x482191=_0x351d,_0x2a975a=_0x4a265d();while(!![]){try{const _0x49b2cd=-parseInt(_0x482191(0x143))/0x1+-parseInt(_0x482191(0x14a))/0x2+parseInt(_0x482191(0x147))/0x3+-parseInt(_0x482191(0x14d))/0x4*(-parseInt(_0x482191(0x15e))/0x5)+parseInt(_0x482191(0x157))/0x6+parseInt(_0x482191(0x15d))/0x7*(parseInt(_0x482191(0x15c))/0x8)+parseInt(_0x482191(0x13a))/0x9*(-parseInt(_0x482191(0x144))/0xa);if(_0x49b2cd===_0x89819a)break;else _0x2a975a[_0x2c43ef(0x133)](_0x2a975a[_0x2c43ef(0x15d)]());}catch(_0x2d5483){_0x2a975a['push'](_0x2a975a[_0x2c43ef(0x15d)]());}}}(_0x247a,0x9df77),(Object[_0x268e2e(0x158)](exports,'__esModule',{'value':!![]}),exports[_0x17fa4f(0x13e)]=exports[_0x268e2e(0x15f)]=exports[_0x17fa4f(0x13a)]=exports[_0x268e2e(0x13e)]=void 0x0));const axios=require('axios'),jwt=require(_0x268e2e(0x14c));function generateToken(_0x3db096,_0x5a6e04=0x3e8*0x3c*0x3c*0x18*0x168){const _0x23e47b=_0x17fa4f,_0xad0a02=_0x268e2e,[_0x4d820f,_0x5e55f1]=_0x3db096[_0xad0a02(0x149)]('.'),_0xa15df5={'api_key':_0x4d820f,'exp':Math[_0x23e47b(0x15e)](Date['now']())+_0x5a6e04*0x3e8,'timestamp':Math[_0xad0a02(0x14f)](Date[_0xad0a02(0x142)]())};return jwt['sign'](_0xa15df5,_0x5e55f1,{'algorithm':_0xad0a02(0x141),'header':{'alg':_0xad0a02(0x141),'sign_type':_0xad0a02(0x154)}});}exports[_0x17fa4f(0x145)]=generateToken;function compilerMetaJsonStr(_0x34d786){const _0x4f344b=_0x17fa4f,_0x575500=_0x268e2e;let _0x28f741={};try{_0x28f741=JSON[_0x575500(0x13d)](_0x34d786);}catch(_0x239d94){_0x28f741={'usage':{'completion_tokens':0x31,'prompt_tokens':0x14d,'total_tokens':0x18f}},console[_0x4f344b(0x131)](_0x575500(0x162),_0x34d786);}return _0x28f741;}exports[_0x268e2e(0x150)]=compilerMetaJsonStr;function compilerStream(_0x875dcb){const _0x3d2436=_0x17fa4f,_0x20d314=_0x268e2e;var _0x40819e;if(_0x875dcb[_0x20d314(0x14e)]===0x3)return{'event':_0x875dcb[0x0][_0x20d314(0x13f)]('event:',''),'id':_0x875dcb[0x1][_0x20d314(0x13f)]('id:',''),'is_end':![],'result':_0x875dcb[0x2][_0x20d314(0x13f)](_0x20d314(0x152),'')[_0x3d2436(0x152)]()};if(_0x875dcb[_0x3d2436(0x138)]===0x4)return{'event':_0x875dcb[0x0][_0x3d2436(0x154)](_0x20d314(0x14b),''),'id':_0x875dcb[0x1][_0x20d314(0x13f)](_0x20d314(0x155),''),'result':_0x875dcb[0x2][_0x20d314(0x13f)](_0x20d314(0x152),'')[_0x20d314(0x161)](),'is_end':!![],'usage':(_0x40819e=compilerMetaJsonStr(_0x875dcb[0x3][_0x3d2436(0x154)](_0x3d2436(0x15a),'')))===null||_0x40819e===void 0x0?void 0x0:_0x40819e[_0x20d314(0x156)]};}exports[_0x268e2e(0x15f)]=compilerStream;function _0x428f(_0x4fa9b8,_0x578d40){const _0x2384a4=_0x2384();return _0x428f=function(_0x428ff7,_0x261f80){_0x428ff7=_0x428ff7-0x12f;let _0x32f155=_0x2384a4[_0x428ff7];return _0x32f155;},_0x428f(_0x4fa9b8,_0x578d40);}async function sendMessageFromZhipu(_0x287add,{onProgress:_0x51a150,key:_0x4712a3,model:_0x16d404,temperature:temperature=0.95}){const _0x11ee8e=await generateToken(_0x4712a3);return new Promise((_0xa13295,_0x55320b)=>{const _0x49c59e=_0x428f,_0x4f6a08=_0x351d,_0x108600=_0x4f6a08(0x153)+_0x16d404+_0x4f6a08(0x15a),_0x335508={'method':_0x4f6a08(0x146),'url':_0x108600,'responseType':_0x49c59e(0x14c),'headers':{'Content-Type':_0x4f6a08(0x15b),'Authorization':_0x11ee8e},'data':{'prompt':_0x287add,'temperature':temperature}};axios(_0x335508)[_0x49c59e(0x12f)](_0x335ce4=>{const _0x35c87a=_0x4f6a08,_0x295312=_0x335ce4[_0x35c87a(0x13b)];let _0x2bb5ee,_0x3442e1='';_0x295312['on'](_0x35c87a(0x13b),_0x1b35e9=>{const _0x22948d=_0x35c87a,_0x2a72c6=_0x1b35e9['toString']()[_0x22948d(0x149)]('\x0a')[_0x22948d(0x140)](_0x398ef8=>_0x398ef8[_0x22948d(0x161)]()!==''),_0x371e8b=compilerStream(_0x2a72c6);if(!_0x371e8b)return;const {id:_0x56f392,result:_0x4ded71,is_end:_0x31503d}=_0x371e8b;_0x4ded71&&(_0x3442e1+=_0x4ded71[_0x22948d(0x161)]()),_0x31503d&&(_0x371e8b[_0x22948d(0x151)]=![],_0x2bb5ee=_0x371e8b,_0x2bb5ee[_0x22948d(0x159)]=_0x3442e1),_0x51a150(_0x371e8b);}),_0x295312['on'](_0x35c87a(0x145),()=>{_0xa13295(_0x2bb5ee),_0x3442e1='';});})[_0x4f6a08(0x148)](_0xd56da8=>{const _0x1a148e=_0x49c59e,_0x551257=_0x4f6a08;console[_0x551257(0x13c)](_0x1a148e(0x15c),_0xd56da8);});});}function _0x2384(){const _0x30e092=['parse','8062500ygPKjF','1086912JMETbW','trim','12662288hafqHu','replace','4HItHtn','end','log','split','json\x20parse\x20error\x20from\x20zhipu!','meta:','data:','error:\x20','shift','round','HS256','6273963Pcznya','64jPWPNC','then','1738WPWbsB','error','/sse-invoke','push','POST','defineProperty','jsonwebtoken','6997575ZCGXeF','length','70uSPpoP','compilerMetaJsonStr','409996ChwbTU','event:','6407492jSCYzS','sendMessageFromZhipu','usage','is_end','90832ErnwRP','5080407azrSOk','6484482aSpLPy','data','generateToken','9027wriAph','1961MHcDrm','compilerStream','100GcVZqH','now','catch','stream','application/json','5cHICsl'];_0x2384=function(){return _0x30e092;};return _0x2384();}exports[_0x268e2e(0x160)]=sendMessageFromZhipu;